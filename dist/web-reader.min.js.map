{"version":3,"sources":["node_modules/browser-pack/_prelude.js","lang/en-GB.json","main.js","node_modules/damerau-levenshtein/damerau-levenshtein.js","src/commands.js","src/dom/document.js","src/dom/dom.js","src/dom/headers.js","src/dom/links.js","src/dom/main.js","src/helpers/event-emitter.js","src/helpers/string-comparers/damerau-levenshtein-comparer.js","src/helpers/string-comparers/string-comparer.js","src/helpers/timer.js","src/main.js","src/reader/recognizer.js","src/reader/speaker.js","src/router.js","src/webreader-error.js"],"names":["f","exports","module","define","amd","g","window","global","self","this","WebReader","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length",1,"commands","READ_ALL_HEADERS","text","variations","READ_ALL_LINKS","READ_LEVEL_HEADERS","levels","READ_MAIN","SEARCH_MAIN","READ_AGAIN","READ_PREVIOUS","READ_NEXT","READ_PAGE_TITLE","READ_LINKS_IN_ELEMENT","GO_TO_PREVIOUS_PAGE","GO_TO_NEXT_PAGE","READ_PAGE_SUMMARY","GO_TO_HOMEPAGE","GO_TO_LINK","elements","MAIN","selector","NAV","HEADER","FOOTER",2,"DamerauLevenshtein","prices","damerau","distance","down","across","ds","split","unshift","forEach","d","j","insert","remove","Math","min","substitute","transpose","c","from","to","backward","forward",3,"factory","mod","stringComparer","_stringComparer","_interopRequireDefault","obj","__esModule","default","_classCallCheck","instance","Constructor","TypeError","extractHeaderLevel","StringComparer","recognizedText","headingLevels","translation","data","regexp","RegExp","test","level","closerMatchIndex","findCloserMatch","index","findElementInText","foundElement","key","join","document","querySelector","extractElementFromText","element","closerMatches","push","closestMatch","extractData","command","Object","defineProperty","value","_stringComparer2","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","protoProps","staticProps","prototype","Commands","Comparer","arguments","get","currentTranslation","minDistance","Number","POSITIVE_INFINITY","foundCommand","toLocaleLowerCase","closerMatch","concat","assign","./helpers/string-comparers/string-comparer",4,"getTitle","title",5,"headers","links","main","_document","_headers","_links","_main","highlightElement","HTMLElement","innerHTML","unhighlightElement","replace","getHeaders","getLinks","getMain","./document","./headers","./links","./main",6,"getHeaderLevel","nodeName","toLowerCase","indexOf","parseInt","charAt","createHeadingsStructure","tree","recurse","headerLevel","header","subheadings","filters","undefined","filterTextRegExp","Array","querySelectorAll","filter","textContent","search",7,"isScreenReaderVisible","getComputedStyle","display","getAttribute","ancestor",8,"possibleMain",9,"EventEmitter","eventName","namespace","properties","customEvent","createEvent","initEvent","property","hasOwnProperty","ex","dispatchEvent",10,"damerauLevenshtein","_damerauLevenshtein","_possibleConstructorReturn","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","_damerauLevenshtein2","DamerauLevenshteinComparer","_StringComparer","getPrototypeOf","apply","string","isArray","./string-comparer","damerau-levenshtein",11,"callee","name",12,"Timer","milliseconds","Promise","resolve","setTimeout",13,"dom","recognizer","router","speaker","eventEmitter","damerauLevenshteinComparer","timer","webreaderError","enGB","_commands","_dom","_recognizer","_router","_speaker","_eventEmitter","_damerauLevenshteinComparer","_timer","_webreaderError","_enGB","downloadTranslation","translationsPath","language","fetch","then","response","json","translations","set","listenShortcuts","webReader","event","ctrlKey","which","isInteracting","state","statusMap","_dom2","currentIndex","stopCommand","receiveCommand","_commands2","_recognizer2","_router2","_speaker2","_eventEmitter2","_damerauLevenshteinComparer2","_timer2","_webreaderError2","_enGB2","defaultLanguage","defaults","delay","lang","voice","defaultState","eventListenersMap","WeakMap","Map","_this","options","settings","has","message","fireEvent","speak","err","eventListeners","bind","documentElement","addEventListener","removeEventListener","_this2","recognize","recognizeCommand","recognizedCommand","route","error","abort","cancel","_this3","reduce","promise","reject","wait","readCurrentElement","currentElement","location","href","_this4","link","oldTabIndex","setAttribute","removeTabIndex","removeAttribute","focus","history","back","../lang/en-GB.json","./commands","./dom/dom","./helpers/event-emitter","./helpers/string-comparers/damerau-levenshtein-comparer","./helpers/timer","./reader/recognizer","./reader/speaker","./router","./webreader-error",14,"getRecognizer","SpeechRecognition","webkitSpeechRecognition","bindEvents","eventsHash","unbindEvents","Recognizer","_Recognizer","audiostart","result","resultIndex","results","isFinal","bestGuess","transcript","noMatch","end","start","../helpers/event-emitter","../webreader-error",15,"getSpeaker","speechSynthesis","setUtteranceSettings","utterance","voices","_loop","voiceURI","pop","isCancelledSymbol","Symbol","Speaker","getVoices","onVoicesChanged","SpeechSynthesisUtterance","eventData",16,"Router","readHeaders","readLinks","readMain","searchMain","readPreviousElement","readNextElement","readPageTitle","goToPreviousPage","goToNextPage","readPageSummary","goToHomepage","goToLink",17,"WebReaderError"],"mappings":"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","file":"web-reader.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","module.exports={\n   \"commands\": {\n      \"READ_ALL_HEADERS\": {\n         \"text\": \"read all headers\",\n         \"variations\": [\n            \"read headers\",\n            \"read all the headers\"\n         ]\n      },\n      \"READ_ALL_LINKS\": {\n         \"text\": \"read all links\",\n         \"variations\": [\n            \"read links\",\n            \"read all the links\"\n         ]\n      },\n      \"READ_LEVEL_HEADERS\": {\n         \"text\": \"read all h\",\n         \"variations\": [\n            \"read h\",\n            \"read all the h\"\n         ],\n         \"levels\": [\n            \"one\",\n            \"two\",\n            \"three\",\n            \"four\",\n            \"five\",\n            \"six\"\n         ]\n      },\n      \"READ_MAIN\": {\n         \"text\": \"read main content\",\n         \"variations\": [\n            \"read the main\",\n            \"read the main content\"\n         ]\n      },\n      \"SEARCH_MAIN\": {\n         \"text\": \"search main content\",\n         \"variations\": [\n            \"search the main\",\n            \"search the main content\",\n            \"find main content\",\n            \"find the main\",\n            \"find the main content\"\n         ]\n      },\n      \"READ_AGAIN\": {\n         \"text\": \"read element again\",\n         \"variations\": [\n            \"read the current element again\",\n            \"read again\"\n         ]\n      },\n      \"READ_PREVIOUS\": {\n         \"text\": \"read previous element\",\n         \"variations\": [\n            \"read previous\"\n         ]\n      },\n      \"READ_NEXT\": {\n         \"text\": \"read next element\",\n         \"variations\": [\n            \"read next\"\n         ]\n      },\n      \"READ_PAGE_TITLE\": {\n         \"text\": \"read page title\",\n         \"variations\": [\n            \"read title\",\n            \"read the title of the page\",\n            \"read document title\"\n         ]\n      },\n      \"READ_LINKS_IN_ELEMENT\": {\n         \"text\": \"read links inside\",\n         \"variations\": [\n            \"read links contained\",\n            \"read links contained in\",\n            \"read all links inside\",\n            \"read all links contained\",\n            \"read all links contained in\"\n         ]\n      },\n      \"GO_TO_PREVIOUS_PAGE\": {\n         \"text\": \"previous page\",\n         \"variations\": [\n            \"go to previous page\"\n         ]\n      },\n      \"GO_TO_NEXT_PAGE\": {\n         \"text\": \"next page\",\n         \"variations\": [\n            \"go to next page\"\n         ]\n      },\n      \"READ_PAGE_SUMMARY\": {\n         \"text\": \"read page summary\",\n         \"variations\": [\n            \"summarize page\",\n            \"summarize the page\"\n         ]\n      },\n      \"GO_TO_HOMEPAGE\": {\n         \"text\": \"homepage\",\n         \"variations\": [\n            \"go to homepage\"\n         ]\n      },\n      \"GO_TO_LINK\": {\n         \"text\": \"go to link\",\n         \"variations\": [\n            \"follow link\",\n            \"go\",\n            \"go there\"\n         ]\n      }\n   },\n   \"elements\": {\n      \"MAIN\": {\n         \"selector\": \"main\",\n         \"variations\": [\n            \"main\"\n         ]\n      },\n      \"NAV\": {\n         \"selector\": \"nav\",\n         \"variations\": [\n            \"nav\",\n            \"navigation\",\n            \"menu\"\n         ]\n      },\n      \"HEADER\": {\n         \"selector\": \"header\",\n         \"variations\": [\n            \"header\"\n         ]\n      },\n      \"FOOTER\": {\n         \"selector\": \"footer\",\n         \"variations\": [\n            \"footer\"\n         ]\n      }\n   }\n}","(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.WebReader = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\nmodule.exports={\n   \"commands\": {\n      \"READ_ALL_HEADERS\": {\n         \"text\": \"read all headers\",\n         \"variations\": [\n            \"read headers\",\n            \"read all the headers\"\n         ]\n      },\n      \"READ_ALL_LINKS\": {\n         \"text\": \"read all links\",\n         \"variations\": [\n            \"read links\",\n            \"read all the links\"\n         ]\n      },\n      \"READ_LEVEL_HEADERS\": {\n         \"text\": \"read all h\",\n         \"variations\": [\n            \"read h\",\n            \"read all the h\"\n         ],\n         \"levels\": [\n            \"one\",\n            \"two\",\n            \"three\",\n            \"four\",\n            \"five\",\n            \"six\"\n         ]\n      },\n      \"READ_MAIN\": {\n         \"text\": \"read main content\",\n         \"variations\": [\n            \"read the main\",\n            \"read the main content\"\n         ]\n      },\n      \"SEARCH_MAIN\": {\n         \"text\": \"search main content\",\n         \"variations\": [\n            \"search the main\",\n            \"search the main content\",\n            \"find main content\",\n            \"find the main\",\n            \"find the main content\"\n         ]\n      },\n      \"READ_AGAIN\": {\n         \"text\": \"read element again\",\n         \"variations\": [\n            \"read the current element again\",\n            \"read again\"\n         ]\n      },\n      \"READ_PREVIOUS\": {\n         \"text\": \"read previous element\",\n         \"variations\": [\n            \"read previous\"\n         ]\n      },\n      \"READ_NEXT\": {\n         \"text\": \"read next element\",\n         \"variations\": [\n            \"read next\"\n         ]\n      },\n      \"READ_PAGE_TITLE\": {\n         \"text\": \"read page title\",\n         \"variations\": [\n            \"read title\",\n            \"read the title of the page\",\n            \"read document title\"\n         ]\n      },\n      \"READ_LINKS_IN_ELEMENT\": {\n         \"text\": \"read links inside\",\n         \"variations\": [\n            \"read links contained\",\n            \"read links contained in\",\n            \"read all links inside\",\n            \"read all links contained\",\n            \"read all links contained in\"\n         ]\n      },\n      \"GO_TO_PREVIOUS_PAGE\": {\n         \"text\": \"previous page\",\n         \"variations\": [\n            \"go to previous page\"\n         ]\n      },\n      \"GO_TO_NEXT_PAGE\": {\n         \"text\": \"next page\",\n         \"variations\": [\n            \"go to next page\"\n         ]\n      },\n      \"READ_PAGE_SUMMARY\": {\n         \"text\": \"read page summary\",\n         \"variations\": [\n            \"summarize page\",\n            \"summarize the page\"\n         ]\n      },\n      \"GO_TO_HOMEPAGE\": {\n         \"text\": \"homepage\",\n         \"variations\": [\n            \"go to homepage\"\n         ]\n      },\n      \"GO_TO_LINK\": {\n         \"text\": \"go to link\",\n         \"variations\": [\n            \"follow link\",\n            \"go\",\n            \"go there\"\n         ]\n      }\n   },\n   \"elements\": {\n      \"MAIN\": {\n         \"selector\": \"main\",\n         \"variations\": [\n            \"main\"\n         ]\n      },\n      \"NAV\": {\n         \"selector\": \"nav\",\n         \"variations\": [\n            \"nav\",\n            \"navigation\",\n            \"menu\"\n         ]\n      },\n      \"HEADER\": {\n         \"selector\": \"header\",\n         \"variations\": [\n            \"header\"\n         ]\n      },\n      \"FOOTER\": {\n         \"selector\": \"footer\",\n         \"variations\": [\n            \"footer\"\n         ]\n      }\n   }\n}\n},{}],2:[function(require,module,exports){\nfunction DamerauLevenshtein (prices, damerau) {\n    // 'prices' customisation of the edit costs by passing an\n    // object with optional 'insert', 'remove', 'substitute', and\n    // 'transpose' keys, corresponding to either a constant\n    // number, or a function that returns the cost. The default\n    // cost for each operation is 1. The price functions take\n    // relevant character(s) as arguments, should return numbers,\n    // and have the following form:\n    //\n    // insert: function (inserted) { return NUMBER; }\n    //\n    // remove: function (removed) { return NUMBER; }\n    //\n    // substitute: function (from, to) { return NUMBER; }\n    //\n    // transpose: function (backward, forward) { return NUMBER; }\n    //\n    // The damerau flag allows us to turn off transposition and\n    // only do plain Levenshtein distance.\n\n    if (damerau !== false) damerau = true;\n    if (!prices) prices = {};\n    var insert, remove, substitute, transpose;\n\n    switch (typeof prices.insert) {\n    case 'function': insert = prices.insert; break;\n    case 'number': insert = function (c) { return prices.insert; }; break;\n    default: insert = function (c) { return 1; }; break; }\n\n    switch (typeof prices.remove) {\n    case 'function': remove = prices.remove; break;\n    case 'number': remove = function (c) { return prices.remove; }; break;\n    default: remove = function (c) { return 1; }; break; }\n\n    switch (typeof prices.substitute) {\n    case 'function': substitute = prices.substitute; break;\n    case 'number':\n        substitute = function (from, to) { return prices.substitute; };\n        break;\n    default: substitute = function (from, to) { return 1; }; break; }\n\n    switch (typeof prices.transpose) {\n    case 'function': transpose = prices.transpose; break;\n    case 'number':\n        transpose = function (backward, forward) { return prices.transpose; };\n        break;\n    default: transpose = function (backward, forward) { return 1; }; break; }\n\n    function distance(down, across) {\n        // http://en.wikipedia.org/wiki/Damerau%E2%80%93Levenshtein_distance\n        var ds = [];\n        if ( down === across ) {\n            return 0;\n        } else {\n            down = down.split(''); down.unshift(null);\n            across = across.split(''); across.unshift(null);\n            down.forEach(function (d, i) {\n                if (!ds[i]) ds[i] = [];\n                across.forEach(function (a, j) {\n                    if (i === 0 && j === 0) ds[i][j] = 0;\n                    // Empty down (i == 0) -> across[1..j] by inserting\n                    else if (i === 0) ds[i][j] = ds[i][j-1] + insert(a);\n                    // Down -> empty across (j == 0) by deleting\n                    else if (j === 0) ds[i][j] = ds[i-1][j] + remove(d);\n                    else {\n                        // Find the least costly operation that turns\n                        // the prefix down[1..i] into the prefix\n                        // across[1..j] using already calculated costs\n                        // for getting to shorter matches.\n                        ds[i][j] = Math.min(\n                            // Cost of editing down[1..i-1] to\n                            // across[1..j] plus cost of deleting\n                            // down[i] to get to down[1..i-1].\n                            ds[i-1][j] + remove(d),\n                            // Cost of editing down[1..i] to\n                            // across[1..j-1] plus cost of inserting\n                            // across[j] to get to across[1..j].\n                            ds[i][j-1] + insert(a),\n                            // Cost of editing down[1..i-1] to\n                            // across[1..j-1] plus cost of\n                            // substituting down[i] (d) with across[j]\n                            // (a) to get to across[1..j].\n                            ds[i-1][j-1] + (d === a ? 0 : substitute(d, a))\n                        );\n                        // Can we match the last two letters of down\n                        // with across by transposing them? Cost of\n                        // getting from down[i-2] to across[j-2] plus\n                        // cost of moving down[i-1] forward and\n                        // down[i] backward to match across[j-1..j].\n                        if (damerau\n                            && i > 1 && j > 1\n                            && down[i-1] === a && d === across[j-1]) {\n                            ds[i][j] = Math.min(\n                                ds[i][j],\n                                ds[i-2][j-2] + (d === a ? 0 : transpose(d, down[i-1]))\n                            );\n                        };\n                    };\n                });\n            });\n            return ds[down.length-1][across.length-1];\n        };\n    };\n    return distance;\n};\n\nmodule.exports = DamerauLevenshtein;\n\n},{}],3:[function(require,module,exports){\n(function (global, factory) {\n   if (typeof define === \"function\" && define.amd) {\n      define('WebReader', ['module', 'exports', './helpers/string-comparers/string-comparer'], factory);\n   } else if (typeof exports !== \"undefined\") {\n      factory(module, exports, require('./helpers/string-comparers/string-comparer'));\n   } else {\n      var mod = {\n         exports: {}\n      };\n      factory(mod, mod.exports, global.stringComparer);\n      global.WebReader = mod.exports;\n   }\n})(this, function (module, exports, _stringComparer) {\n   'use strict';\n\n   Object.defineProperty(exports, \"__esModule\", {\n      value: true\n   });\n\n   var _stringComparer2 = _interopRequireDefault(_stringComparer);\n\n   function _interopRequireDefault(obj) {\n      return obj && obj.__esModule ? obj : {\n         default: obj\n      };\n   }\n\n   function _classCallCheck(instance, Constructor) {\n      if (!(instance instanceof Constructor)) {\n         throw new TypeError(\"Cannot call a class as a function\");\n      }\n   }\n\n   var _createClass = function () {\n      function defineProperties(target, props) {\n         for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n         }\n      }\n\n      return function (Constructor, protoProps, staticProps) {\n         if (protoProps) defineProperties(Constructor.prototype, protoProps);\n         if (staticProps) defineProperties(Constructor, staticProps);\n         return Constructor;\n      };\n   }();\n\n   /**\n    * The translation currently in use\n    *\n    * @type {Object}\n    */\n   var translation = null;\n\n   /**\n    * @typedef CommandsHash\n    * @type {Object}\n    * @property {string} command The command recognized\n    * @property {string} [translationsPath=''] The path to the translations folder\n    * @property {Object} [recognizer] The settings for the speech recognition functionality\n    */\n\n   /**\n    * Extracts the heading level contained in the string provided.\n    * If a perfect match is not found, the Damerau-Levenshtein algorithm\n    * is used to find the closest match.\n    *\n    * @param {StringComparer} StringComparer The comparer to use for comparing strings\n    * @param {string} recognizedText The string to analyze\n    *\n    * @return {Object}\n    */\n   function extractHeaderLevel(StringComparer, recognizedText) {\n      var headingLevels = translation.commands.READ_LEVEL_HEADERS.levels;\n      var data = {};\n\n      for (var i = 0; i < headingLevels.length; i++) {\n         var regexp = new RegExp('(^|\\\\b)(' + (i + 1) + '|h' + (i + 1) + '|' + headingLevels[i] + ')(\\\\b|$)', 'i');\n\n         if (regexp.test(recognizedText)) {\n            data.level = i + 1;\n            break;\n         }\n      }\n\n      // If the header level has not been found yet,\n      // let's try a more heuristic strategy\n      if (!data.level) {\n         var closerMatchIndex = StringComparer.findCloserMatch(headingLevels, recognizedText).index;\n\n         data.level = closerMatchIndex === -1 ? -1 : closerMatchIndex + 1;\n      }\n\n      return data;\n   }\n\n   /**\n    * Searches an element type, such as <code>main</code> or <code>footer</code>,\n    * in the text provided. If none is found, <code>null</code> is returned\n    *\n    * @param {string} recognizedText The string to analyze\n    *\n    * @return {HTMLElement|null}\n    */\n   function findElementInText(recognizedText) {\n      var elements = translation.elements;\n      var foundElement = null;\n\n      for (var key in elements) {\n         var variations = elements[key].variations.join('|');\n         var regexp = new RegExp('(^|\\\\b)(' + variations + ')(\\\\b|$)', 'i');\n\n         if (regexp.test(recognizedText)) {\n            foundElement = document.querySelector(elements[key].selector);\n            break;\n         }\n      }\n\n      return foundElement;\n   }\n   /**\n    * Searches an element type, such as <code>main</code> or <code>footer</code>,\n    * in the text provided. If none is found, the closest match is re is returned\n    *\n    * @param {StringComparer} StringComparer The comparer to use for comparing strings\n    * @param {string} recognizedText The string to analyze\n    *\n    * @return {Object}\n    */\n   function extractElementFromText(StringComparer, recognizedText) {\n      var foundElement = findElementInText(recognizedText);\n\n      if (foundElement) {\n         return {\n            element: foundElement\n         };\n      }\n\n      // Collects the closer match for each element.\n      var closerMatches = [];\n      var elements = translation.elements;\n\n      // If the element has not been found yet,\n      // let's try a more heuristic strategy\n      for (var key in elements) {\n         var variations = elements[key].variations;\n         var closerMatchIndex = StringComparer.findCloserMatch(variations, recognizedText);\n\n         if (closerMatchIndex !== -1) {\n            closerMatches.push(variations[closerMatchIndex]);\n         }\n      }\n\n      // Find the closest match among the closest match\n      var closestMatch = StringComparer.findCloserMatch(closerMatches, recognizedText);\n\n      return {\n         element: closestMatch.index >= 0 ? closerMatches[closestMatch.index] : null\n      };\n   }\n\n   /**\n    * Extracts relevant data from a string, based on the recognized command\n    *\n    * @param {StringComparer} StringComparer The comparer to use for comparing strings\n    * @param {string} command The recognized command\n    * @param {string} recognizedText The string from which the data are extracted\n    *\n    * @return {Object}\n    */\n   function extractData(StringComparer, command, recognizedText) {\n      var data = {};\n\n      if (command === 'READ_LEVEL_HEADERS') {\n         data = extractHeaderLevel(StringComparer, recognizedText);\n      } else if (command === 'READ_LINKS_IN_ELEMENT') {\n         data = extractElementFromText(StringComparer, recognizedText);\n      }\n\n      return data;\n   }\n\n   /**\n    * The class responsible for the commands\n    *\n    * @class\n    */\n\n   var Commands = function () {\n      /**\n       * Creates an instance of Commands\n       *\n       * @constructor\n       *\n       * @param {StringComparer} Comparer The class representing the strategy to adopt to compare strings\n       */\n\n      function Commands(Comparer) {\n         _classCallCheck(this, Commands);\n\n         if (!(Comparer.prototype instanceof _stringComparer2.default)) {\n            throw new TypeError(arguments[0] + ' is not an instance of StringComparer');\n         }\n\n         Object.defineProperty(this, 'StringComparer', {\n            enumerable: false,\n            configurable: false,\n            get: function get() {\n               return Comparer;\n            }\n         });\n      }\n\n      /**\n       * Detects the action to perform and extracts any relevant data\n       * based on the string provided\n       *\n       * @param {string} recognizedText The string to analyze\n       * @param {Object} currentTranslation The object containing the translation of the application\n       *\n       * @return {CommandsHash}\n       */\n\n\n      _createClass(Commands, [{\n         key: 'recognizeCommand',\n         value: function recognizeCommand(recognizedText, currentTranslation) {\n            var minDistance = Number.POSITIVE_INFINITY;\n            var commands = currentTranslation.commands;\n            var foundCommand = void 0;\n\n            translation = currentTranslation;\n            recognizedText = recognizedText.toLocaleLowerCase();\n\n            for (var command in commands) {\n               var closerMatch = this.StringComparer.findCloserMatch([commands[command].text].concat(commands[command].variations), recognizedText);\n\n               if (closerMatch.distance < minDistance) {\n                  foundCommand = Object.assign({\n                     command: command\n                  }, extractData(this.StringComparer, command, recognizedText));\n\n                  if (closerMatch.distance === 0) {\n                     break;\n                  } else {\n                     minDistance = closerMatch.distance;\n                  }\n               }\n            }\n\n            return foundCommand;\n         }\n      }]);\n\n      return Commands;\n   }();\n\n   exports.default = Commands;\n   module.exports = exports['default'];\n});\n\n},{\"./helpers/string-comparers/string-comparer\":11}],4:[function(require,module,exports){\n(function (global, factory) {\n   if (typeof define === \"function\" && define.amd) {\n      define(\"WebReader\", [\"exports\"], factory);\n   } else if (typeof exports !== \"undefined\") {\n      factory(exports);\n   } else {\n      var mod = {\n         exports: {}\n      };\n      factory(mod.exports);\n      global.WebReader = mod.exports;\n   }\n})(this, function (exports) {\n   \"use strict\";\n\n   Object.defineProperty(exports, \"__esModule\", {\n      value: true\n   });\n   /**\n    * Returns the title of the current document\n    *\n    * @return {string}\n    */\n   function getTitle() {\n      return document.title;\n   }\n\n   exports.getTitle = getTitle;\n});\n\n},{}],5:[function(require,module,exports){\n(function (global, factory) {\n   if (typeof define === \"function\" && define.amd) {\n      define('WebReader', ['module', 'exports', './document', './headers', './links', './main'], factory);\n   } else if (typeof exports !== \"undefined\") {\n      factory(module, exports, require('./document'), require('./headers'), require('./links'), require('./main'));\n   } else {\n      var mod = {\n         exports: {}\n      };\n      factory(mod, mod.exports, global.document, global.headers, global.links, global.main);\n      global.WebReader = mod.exports;\n   }\n})(this, function (module, exports, _document, _headers, _links, _main) {\n   'use strict';\n\n   Object.defineProperty(exports, \"__esModule\", {\n      value: true\n   });\n\n\n   /**\n    * Highlights an element in the current document by wrapping it\n    * with a <code>mark</code> element\n    *\n    * @param {HTMLElement} element The element to highlight\n    */\n   function highlightElement(element) {\n      if (!element instanceof HTMLElement) {\n         return;\n      }\n\n      element.innerHTML = '<mark>' + element.innerHTML + '</mark>';\n   }\n\n   /**\n    * Unhighlights an element in the current document by removing\n    * the <code>mark</code> element wrapping it\n    *\n    * @param {HTMLElement} element The element to unhighlight\n    */\n   function unhighlightElement(element) {\n      if (!element instanceof HTMLElement) {\n         return;\n      }\n\n      element.innerHTML = element.innerHTML.replace(/^<mark>/, '').replace(/<\\/mark>$/, '');\n   }\n\n   exports.default = {\n      getHeaders: _headers.getHeaders,\n      getLinks: _links.getLinks,\n      getMain: _main.getMain,\n      getTitle: _document.getTitle,\n      highlightElement: highlightElement,\n      unhighlightElement: unhighlightElement\n   };\n   module.exports = exports['default'];\n});\n\n},{\"./document\":4,\"./headers\":6,\"./links\":7,\"./main\":8}],6:[function(require,module,exports){\n(function (global, factory) {\n   if (typeof define === \"function\" && define.amd) {\n      define('WebReader', ['exports'], factory);\n   } else if (typeof exports !== \"undefined\") {\n      factory(exports);\n   } else {\n      var mod = {\n         exports: {}\n      };\n      factory(mod.exports);\n      global.WebReader = mod.exports;\n   }\n})(this, function (exports) {\n   'use strict';\n\n   Object.defineProperty(exports, \"__esModule\", {\n      value: true\n   });\n   /**\n    * Returns the level of a header (1 for an <code>h1</code>, 2 for an <code>h2</code>,\n    * and so on). If the element is not an header or it is not defined, zero is returned\n    *\n    * @param {HTMLElement} element\n    *\n    * @return {number}\n    */\n   function getHeaderLevel(element) {\n      if (!element || !element.nodeName || element.nodeName.toLowerCase().indexOf('h') !== 0) {\n         return 0;\n      }\n\n      return parseInt(element.nodeName.charAt(1), 10);\n   }\n\n   /**\n    * Returns all the headers of a page in a tree structure. Each element\n    * possesses two properties: element and subheadings. The former\n    * is an <code>HTMLElement</code> referencing the header, while the latter is an array\n    * containing all the subheadings of the header.\n    *\n    * @return {Object[]}\n    */\n   function createHeadingsStructure(headers) {\n      var tree = [];\n\n      (function recurse(headers, index, tree) {\n         if (headers.length === 0 || index.index === headers.length) {\n            return tree;\n         }\n\n         var headerLevel = getHeaderLevel(headers[index.index]);\n         var header = {\n            element: headers[index.index],\n            subheadings: []\n         };\n\n         if (tree.length === 0 || headerLevel === getHeaderLevel(tree[tree.length - 1].element)) {\n            tree.push(header);\n            index.index++;\n\n            return recurse(headers, index, tree);\n         }\n\n         if (headerLevel > getHeaderLevel(tree[tree.length - 1].element)) {\n            tree[tree.length - 1].subheadings = recurse(headers, index, []);\n         }\n\n         headerLevel = getHeaderLevel(headers[index.index]);\n\n         if (headerLevel === getHeaderLevel(tree[tree.length - 1].element)) {\n            return recurse(headers, index, tree);\n         } else {\n            return tree;\n         }\n      })(headers, { index: 0 }, tree);\n   }\n\n   /**\n    * Returns all the headers of a page, optionally filtered\n    *\n    * @param {Object} [filters={}] An object used to filters the headers to return\n    * @param {number} [filters.level=-1] An integer that specifies the level to retrieve.\n    * If set  to -1 retrieves all the headers\n    * @param {string} [filters.text=''] A string that must be contained in the header's text\n    *\n    * @return {HTMLElement[]}\n    */\n   function getHeaders() {\n      var filters = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n      var selector = void 0;\n\n      filters = Object.assign({\n         level: -1,\n         text: ''\n      }, filters);\n\n      if (filters.level === -1) {\n         selector = 'h1, h2, h3, h4, h5, h6';\n      } else {\n         selector = 'h' + filters.level;\n      }\n\n      var filterTextRegExp = new RegExp('(^|\\\\b)' + filters.text + '(\\\\b|$)', 'i');\n      var headers = Array.from(document.querySelectorAll(selector)).filter(function (header) {\n         return header.textContent.search(filterTextRegExp) >= 0;\n      });\n\n      return headers;\n   }\n\n   exports.createHeadingsStructure = createHeadingsStructure;\n   exports.getHeaders = getHeaders;\n});\n\n},{}],7:[function(require,module,exports){\n(function (global, factory) {\n   if (typeof define === \"function\" && define.amd) {\n      define('WebReader', ['exports'], factory);\n   } else if (typeof exports !== \"undefined\") {\n      factory(exports);\n   } else {\n      var mod = {\n         exports: {}\n      };\n      factory(mod.exports);\n      global.WebReader = mod.exports;\n   }\n})(this, function (exports) {\n   'use strict';\n\n   Object.defineProperty(exports, \"__esModule\", {\n      value: true\n   });\n   /**\n    * Determines if a link would be read or not by a classic screen reader\n    *\n    * @param {HTMLElement} element The element to test\n    *\n    * @return {boolean}\n    */\n   function isScreenReaderVisible(element) {\n      return window.getComputedStyle(element).display !== 'none' && element.getAttribute('aria-hidden') !== 'true';\n   }\n\n   /**\n    * Returns all the links of a page, optionally filtered\n    *\n    * @param {Object} [filters={}] An object used to filters the links\n    * @param {(HTMLElement|HTMLDocument)} [filters.ancestor=document] The ancestor of the links to retrieve\n    *\n    * @return {HTMLElement[]}\n    */\n   function getLinks() {\n      var filters = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n      filters = Object.assign({\n         ancestor: document\n      }, filters);\n\n      var links = filters.ancestor.querySelectorAll('a');\n\n      return Array.from(links).filter(function (element) {\n         return isScreenReaderVisible(element);\n      });\n   }\n\n   exports.getLinks = getLinks;\n});\n\n},{}],8:[function(require,module,exports){\n(function (global, factory) {\n   if (typeof define === \"function\" && define.amd) {\n      define('WebReader', ['exports'], factory);\n   } else if (typeof exports !== \"undefined\") {\n      factory(exports);\n   } else {\n      var mod = {\n         exports: {}\n      };\n      factory(mod.exports);\n      global.WebReader = mod.exports;\n   }\n})(this, function (exports) {\n   'use strict';\n\n   Object.defineProperty(exports, \"__esModule\", {\n      value: true\n   });\n   /**\n    * Returns the main element of the page.\n    * If the element is not found, an heuristic is employed to find a possible\n    * main element. If the heuristic approach fails, <code>null</code> is returned\n    *\n    * @return {HTMLElement|null}\n    */\n   function getMain() {\n      var main = document.querySelector('main') || document.querySelector('[role=\"main\"]');\n\n      // If a main has not been found, let's use an heuristic to find\n      // a possible main content that has not been marked as such.\n      if (!main) {\n         var possibleMain = document.querySelectorAll('#main-content, .main-content, #main, .main');\n\n         // If only one element is found, it's highly possible\n         // that it's the true main content of the page.\n         if (possibleMain.length === 1) {\n            main = possibleMain[0];\n         }\n      }\n\n      return main;\n   }\n\n   exports.getMain = getMain;\n});\n\n},{}],9:[function(require,module,exports){\n(function (global, factory) {\n   if (typeof define === \"function\" && define.amd) {\n      define('WebReader', ['module', 'exports'], factory);\n   } else if (typeof exports !== \"undefined\") {\n      factory(module, exports);\n   } else {\n      var mod = {\n         exports: {}\n      };\n      factory(mod, mod.exports);\n      global.WebReader = mod.exports;\n   }\n})(this, function (module, exports) {\n   'use strict';\n\n   Object.defineProperty(exports, \"__esModule\", {\n      value: true\n   });\n\n   function _classCallCheck(instance, Constructor) {\n      if (!(instance instanceof Constructor)) {\n         throw new TypeError(\"Cannot call a class as a function\");\n      }\n   }\n\n   var _createClass = function () {\n      function defineProperties(target, props) {\n         for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n         }\n      }\n\n      return function (Constructor, protoProps, staticProps) {\n         if (protoProps) defineProperties(Constructor.prototype, protoProps);\n         if (staticProps) defineProperties(Constructor, staticProps);\n         return Constructor;\n      };\n   }();\n\n   var EventEmitter = function () {\n      function EventEmitter() {\n         _classCallCheck(this, EventEmitter);\n      }\n\n      _createClass(EventEmitter, null, [{\n         key: 'namespaceEvent',\n         value: function namespaceEvent(eventName) {\n            return EventEmitter.namespace + '.' + eventName;\n         }\n      }, {\n         key: 'fireEvent',\n         value: function fireEvent(eventName, element, properties) {\n            var customEvent = document.createEvent('Event');\n\n            customEvent.initEvent(eventName, true, true);\n\n            for (var property in properties) {\n               if (properties.hasOwnProperty(property)) {\n                  try {\n                     customEvent[property] = properties[property];\n                  } catch (ex) {}\n               }\n            }\n\n            element.dispatchEvent(customEvent);\n         }\n      }, {\n         key: 'namespace',\n         get: function get() {\n            return 'webreader';\n         }\n      }]);\n\n      return EventEmitter;\n   }();\n\n   exports.default = EventEmitter;\n   module.exports = exports['default'];\n});\n\n},{}],10:[function(require,module,exports){\n(function (global, factory) {\n   if (typeof define === \"function\" && define.amd) {\n      define('WebReader', ['module', 'exports', 'damerau-levenshtein', './string-comparer'], factory);\n   } else if (typeof exports !== \"undefined\") {\n      factory(module, exports, require('damerau-levenshtein'), require('./string-comparer'));\n   } else {\n      var mod = {\n         exports: {}\n      };\n      factory(mod, mod.exports, global.damerauLevenshtein, global.stringComparer);\n      global.WebReader = mod.exports;\n   }\n})(this, function (module, exports, _damerauLevenshtein, _stringComparer) {\n   'use strict';\n\n   Object.defineProperty(exports, \"__esModule\", {\n      value: true\n   });\n\n   var _damerauLevenshtein2 = _interopRequireDefault(_damerauLevenshtein);\n\n   var _stringComparer2 = _interopRequireDefault(_stringComparer);\n\n   function _interopRequireDefault(obj) {\n      return obj && obj.__esModule ? obj : {\n         default: obj\n      };\n   }\n\n   function _classCallCheck(instance, Constructor) {\n      if (!(instance instanceof Constructor)) {\n         throw new TypeError(\"Cannot call a class as a function\");\n      }\n   }\n\n   var _createClass = function () {\n      function defineProperties(target, props) {\n         for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n         }\n      }\n\n      return function (Constructor, protoProps, staticProps) {\n         if (protoProps) defineProperties(Constructor.prototype, protoProps);\n         if (staticProps) defineProperties(Constructor, staticProps);\n         return Constructor;\n      };\n   }();\n\n   function _possibleConstructorReturn(self, call) {\n      if (!self) {\n         throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n      }\n\n      return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n   }\n\n   function _inherits(subClass, superClass) {\n      if (typeof superClass !== \"function\" && superClass !== null) {\n         throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n      }\n\n      subClass.prototype = Object.create(superClass && superClass.prototype, {\n         constructor: {\n            value: subClass,\n            enumerable: false,\n            writable: true,\n            configurable: true\n         }\n      });\n      if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n   }\n\n   var DamerauLevenshteinComparer = function (_StringComparer) {\n      _inherits(DamerauLevenshteinComparer, _StringComparer);\n\n      function DamerauLevenshteinComparer() {\n         _classCallCheck(this, DamerauLevenshteinComparer);\n\n         return _possibleConstructorReturn(this, Object.getPrototypeOf(DamerauLevenshteinComparer).apply(this, arguments));\n      }\n\n      _createClass(DamerauLevenshteinComparer, null, [{\n         key: 'findCloserMatch',\n         value: function findCloserMatch(string, target) {\n            if (!Array.isArray(string)) {\n               string = [string];\n            }\n\n            var damerauLevenshtein = (0, _damerauLevenshtein2.default)(); // jshint ignore:line\n            var minDistance = Number.POSITIVE_INFINITY;\n            var i = void 0;\n\n            for (i = 0; i < string.length; i++) {\n               var distance = damerauLevenshtein(string[i], target);\n\n               // If a perfect match is found, exit immediately\n               if (distance === 0) {\n                  minDistance = distance;\n                  break;\n               } else if (distance < minDistance) {\n                  minDistance = distance;\n               }\n            }\n\n            return {\n               index: i === string.length ? -1 : i,\n               distance: minDistance\n            };\n         }\n      }]);\n\n      return DamerauLevenshteinComparer;\n   }(_stringComparer2.default);\n\n   exports.default = DamerauLevenshteinComparer;\n   module.exports = exports['default'];\n});\n\n},{\"./string-comparer\":11,\"damerau-levenshtein\":2}],11:[function(require,module,exports){\n(function (global, factory) {\n   if (typeof define === \"function\" && define.amd) {\n      define(\"WebReader\", [\"module\", \"exports\"], factory);\n   } else if (typeof exports !== \"undefined\") {\n      factory(module, exports);\n   } else {\n      var mod = {\n         exports: {}\n      };\n      factory(mod, mod.exports);\n      global.WebReader = mod.exports;\n   }\n})(this, function (module, exports) {\n   \"use strict\";\n\n   Object.defineProperty(exports, \"__esModule\", {\n      value: true\n   });\n\n   function _classCallCheck(instance, Constructor) {\n      if (!(instance instanceof Constructor)) {\n         throw new TypeError(\"Cannot call a class as a function\");\n      }\n   }\n\n   var _createClass = function () {\n      function defineProperties(target, props) {\n         for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n         }\n      }\n\n      return function (Constructor, protoProps, staticProps) {\n         if (protoProps) defineProperties(Constructor.prototype, protoProps);\n         if (staticProps) defineProperties(Constructor, staticProps);\n         return Constructor;\n      };\n   }();\n\n   var StringComparer = function () {\n      function StringComparer() {\n         _classCallCheck(this, StringComparer);\n      }\n\n      _createClass(StringComparer, null, [{\n         key: \"findCloserMatch\",\n         value: function findCloserMatch(string, target) {\n            throw new Error(\"The \" + arguments.callee.name + \" function must be overridden\");\n         }\n      }]);\n\n      return StringComparer;\n   }();\n\n   exports.default = StringComparer;\n   module.exports = exports['default'];\n});\n\n},{}],12:[function(require,module,exports){\n(function (global, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    define(\"WebReader\", [\"module\", \"exports\"], factory);\n  } else if (typeof exports !== \"undefined\") {\n    factory(module, exports);\n  } else {\n    var mod = {\n      exports: {}\n    };\n    factory(mod, mod.exports);\n    global.WebReader = mod.exports;\n  }\n})(this, function (module, exports) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  var _createClass = function () {\n    function defineProperties(target, props) {\n      for (var i = 0; i < props.length; i++) {\n        var descriptor = props[i];\n        descriptor.enumerable = descriptor.enumerable || false;\n        descriptor.configurable = true;\n        if (\"value\" in descriptor) descriptor.writable = true;\n        Object.defineProperty(target, descriptor.key, descriptor);\n      }\n    }\n\n    return function (Constructor, protoProps, staticProps) {\n      if (protoProps) defineProperties(Constructor.prototype, protoProps);\n      if (staticProps) defineProperties(Constructor, staticProps);\n      return Constructor;\n    };\n  }();\n\n  var Timer = function () {\n    function Timer() {\n      _classCallCheck(this, Timer);\n    }\n\n    _createClass(Timer, null, [{\n      key: \"wait\",\n      value: function wait(milliseconds) {\n        return new Promise(function (resolve) {\n          return window.setTimeout(resolve, milliseconds);\n        });\n      }\n    }]);\n\n    return Timer;\n  }();\n\n  exports.default = Timer;\n  module.exports = exports['default'];\n});\n\n},{}],13:[function(require,module,exports){\n(function (global, factory) {\n   if (typeof define === \"function\" && define.amd) {\n      define('WebReader', ['module', 'exports', './commands', './dom/dom', './reader/recognizer', './router', './reader/speaker', './helpers/event-emitter', './helpers/string-comparers/damerau-levenshtein-comparer', './helpers/timer', './webreader-error', '../lang/en-GB.json'], factory);\n   } else if (typeof exports !== \"undefined\") {\n      factory(module, exports, require('./commands'), require('./dom/dom'), require('./reader/recognizer'), require('./router'), require('./reader/speaker'), require('./helpers/event-emitter'), require('./helpers/string-comparers/damerau-levenshtein-comparer'), require('./helpers/timer'), require('./webreader-error'), require('../lang/en-GB.json'));\n   } else {\n      var mod = {\n         exports: {}\n      };\n      factory(mod, mod.exports, global.commands, global.dom, global.recognizer, global.router, global.speaker, global.eventEmitter, global.damerauLevenshteinComparer, global.timer, global.webreaderError, global.enGB);\n      global.WebReader = mod.exports;\n   }\n})(this, function (module, exports, _commands, _dom, _recognizer, _router, _speaker, _eventEmitter, _damerauLevenshteinComparer, _timer, _webreaderError, _enGB) {\n   'use strict';\n\n   Object.defineProperty(exports, \"__esModule\", {\n      value: true\n   });\n\n   var _commands2 = _interopRequireDefault(_commands);\n\n   var _dom2 = _interopRequireDefault(_dom);\n\n   var _recognizer2 = _interopRequireDefault(_recognizer);\n\n   var _router2 = _interopRequireDefault(_router);\n\n   var _speaker2 = _interopRequireDefault(_speaker);\n\n   var _eventEmitter2 = _interopRequireDefault(_eventEmitter);\n\n   var _damerauLevenshteinComparer2 = _interopRequireDefault(_damerauLevenshteinComparer);\n\n   var _timer2 = _interopRequireDefault(_timer);\n\n   var _webreaderError2 = _interopRequireDefault(_webreaderError);\n\n   var _enGB2 = _interopRequireDefault(_enGB);\n\n   function _interopRequireDefault(obj) {\n      return obj && obj.__esModule ? obj : {\n         default: obj\n      };\n   }\n\n   function _classCallCheck(instance, Constructor) {\n      if (!(instance instanceof Constructor)) {\n         throw new TypeError(\"Cannot call a class as a function\");\n      }\n   }\n\n   var _createClass = function () {\n      function defineProperties(target, props) {\n         for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n         }\n      }\n\n      return function (Constructor, protoProps, staticProps) {\n         if (protoProps) defineProperties(Constructor.prototype, protoProps);\n         if (staticProps) defineProperties(Constructor, staticProps);\n         return Constructor;\n      };\n   }();\n\n   var defaultLanguage = 'en-GB';\n\n   /**\n    * @typedef SettingsHash\n    * @type {Object}\n    * @property {number} [delay=300] The delay between each spoken text\n    * @property {string} [translationsPath=''] The path to the translations folder\n    * @property {SpeechRecognitionHash} [recognizer] The settings for the speech recognition functionality\n    * @property {SpeechSynthesisUtteranceHash} [speaker] The settings for the speech synthesis functionality\n    * functionality\n    */\n\n   /**\n    * The default values for the settings available\n    *\n    * @type {SettingsHash}\n    */\n   var defaults = {\n      delay: 300,\n      translationsPath: '',\n      recognizer: {\n         lang: defaultLanguage\n      },\n      speaker: {\n         lang: defaultLanguage,\n         voice: 'Google UK English Female'\n      }\n   };\n\n   var defaultState = {\n      isInteracting: false,\n      elements: null,\n      currentIndex: -1\n   };\n\n   var eventListenersMap = new WeakMap();\n   var statusMap = new WeakMap();\n   var translations = new Map([[defaultLanguage, _enGB2.default]]);\n\n   /**\n    * Downloads a translation for the commands available\n    *\n    * @param {string} translationsPath The path to the translations folder\n    * @param {string} language The language to download\n    *\n    * @return {Promise}\n    */\n   function downloadTranslation(translationsPath, language) {\n      return window.fetch(translationsPath + '/' + language + '.json').then(function (response) {\n         return response.json();\n      }).then(function (response) {\n         translations.set(language, response);\n\n         return response;\n      });\n   }\n\n   /**\n    * Performs certain actions based on the shortcuts pressed by the user\n    *\n    * @param {WebReader} webReader An instance of WebReader\n    * @param {Event} event An event\n    */\n   function listenShortcuts(webReader, event) {\n      if (event.ctrlKey === true && (event.code && event.code === 'Space' || event.which === 32)) {\n         if (webReader.isInteracting()) {\n            var state = statusMap.get(webReader);\n\n            if (state.elements) {\n               _dom2.default.unhighlightElement(state.elements[state.currentIndex]);\n            }\n\n            webReader.stopCommand();\n         } else {\n            webReader.receiveCommand();\n         }\n      }\n   }\n\n   /**\n    * The class representing the library\n    *\n    * @class\n    */\n\n   var WebReader = function () {\n      /**\n       * Creates an instance of WebReader\n       *\n       * @constructor\n       *\n       * @param {SettingsHash} [options={}] The options to customize WebReader\n       */\n\n      function WebReader() {\n         var _this = this;\n\n         var options = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n         _classCallCheck(this, WebReader);\n\n         /**\n          * @type {Object}\n          */\n         this.settings = Object.assign({}, defaults, options);\n         /**\n          *\n          * @type {Recognizer}\n          */\n         this.recognizer = new _recognizer2.default(this.settings.recognizer);\n         /**\n          *\n          * @type {Speaker}\n          */\n         this.speaker = new _speaker2.default(this.settings.speaker);\n\n         statusMap.set(this, Object.assign({}, defaultState));\n         eventListenersMap.set(this, new Map());\n\n         var language = this.settings.recognizer.lang;\n\n         if (language && !translations.has(language)) {\n            downloadTranslation(this.settings.translationsPath, language).then(function () {\n               var message = 'Language \"' + language + '\" successfully loaded';\n\n               _eventEmitter2.default.fireEvent(_eventEmitter2.default.namespace + '.languagedownload', document, {\n                  data: {\n                     lang: language\n                  }\n               });\n\n               return _this.speaker.speak(message);\n            }, function (err) {\n\n               _eventEmitter2.default.fireEvent(_eventEmitter2.default.namespace + '.languageerror', document, {\n                  data: {\n                     lang: language\n                  }\n               });\n\n               return _this.speaker.speak('An error occurred: the language \"' + language + '\" was not loaded');\n            });\n         }\n      }\n\n      /**\n       * Determines if WebReader is currently interacting with the user\n       *\n       * @return {boolean}\n       */\n\n\n      _createClass(WebReader, [{\n         key: 'isInteracting',\n         value: function isInteracting() {\n            return statusMap.get(this).isInteracting;\n         }\n      }, {\n         key: 'enableShortcuts',\n         value: function enableShortcuts() {\n            var eventListeners = eventListenersMap.get(this);\n\n            eventListeners.set('keydown', listenShortcuts.bind(this, this));\n\n            document.documentElement.addEventListener('keydown', eventListeners.get('keydown'));\n\n            return this;\n         }\n      }, {\n         key: 'disableShortcuts',\n         value: function disableShortcuts() {\n            var eventListeners = eventListenersMap.get(this);\n\n            document.documentElement.removeEventListener('keydown', eventListeners.get('keydown'));\n            eventListeners.delete('keydown');\n\n            return this;\n         }\n      }, {\n         key: 'receiveCommand',\n         value: function receiveCommand() {\n            var _this2 = this;\n\n            statusMap.get(this).isInteracting = true;\n\n\n            _eventEmitter2.default.fireEvent(_eventEmitter2.default.namespace + '.interactionstart', document);\n\n            return this.speaker.speak('Ready').then(function () {\n               return _this2.recognizer.recognize();\n            }).then(function (recognizedText) {\n               var commands = new _commands2.default(_damerauLevenshteinComparer2.default);\n               var translation = translations.get(_this2.settings.recognizer.lang);\n\n               return commands.recognizeCommand(recognizedText, translation);\n            }).then(function (recognizedCommand) {\n               return _router2.default.route(_this2, recognizedCommand);\n            }).catch(function (error) {\n               if (error instanceof _webreaderError2.default) {\n                  return _this2.speaker.speak(error.message);\n               }\n\n               if (error.error !== 'aborted' && error.error !== 'interrupted') {\n\n                  statusMap.set(_this2, Object.assign({}, defaultState));\n\n                  return _this2.speaker.speak('Sorry, I could not recognize the command');\n               }\n            }).then( // Simulate an always() method\n            function () {}, function () {}).then(function () {\n               statusMap.get(_this2).isInteracting = false;\n\n\n               _eventEmitter2.default.fireEvent(_eventEmitter2.default.namespace + '.interactionend', document);\n            });\n         }\n      }, {\n         key: 'stopCommand',\n         value: function stopCommand() {\n            this.recognizer.abort();\n            this.speaker.cancel();\n            statusMap.get(this).isInteracting = false;\n         }\n      }, {\n         key: 'readHeaders',\n         value: function readHeaders() {\n            var _this3 = this;\n\n            var filters = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n            var headers = _dom2.default.getHeaders(filters);\n            var level = filters && filters.level ? filters.level : -1;\n\n            statusMap.get(this).elements = headers;\n\n            return headers.reduce(function (promise, header, index) {\n               promise = promise.then(function () {\n                  statusMap.get(_this3).currentIndex = index;\n                  _dom2.default.highlightElement(header);\n\n                  return _this3.speaker.speak(header.textContent + (level !== -1 ? '' : ' ' + header.nodeName)).then(function () {\n                     return _dom2.default.unhighlightElement(header);\n                  }).catch(function (error) {\n                     _dom2.default.unhighlightElement(header);\n\n                     return Promise.reject(error);\n                  });\n               });\n\n               if (_this3.settings.delay > 0) {\n                  promise = promise.then(function () {\n                     return _timer2.default.wait(_this3.settings.delay);\n                  });\n               }\n\n               return promise;\n            }, Promise.resolve());\n         }\n      }, {\n         key: 'readCurrentElement',\n         value: function readCurrentElement() {\n            var state = statusMap.get(this);\n\n            if (!state.elements) {\n               return Promise.reject(new _webreaderError2.default('There is not a current element to read'));\n            }\n\n            var element = state.elements[state.currentIndex];\n\n            _dom2.default.highlightElement(element);\n\n            return this.speaker.speak(element.textContent).then(function () {\n               return _dom2.default.unhighlightElement(element);\n            }).catch(function (error) {\n               _dom2.default.unhighlightElement(element);\n\n               return Promise.reject(error);\n            });\n         }\n      }, {\n         key: 'readPreviousElement',\n         value: function readPreviousElement() {\n            var state = statusMap.get(this);\n\n            if (state.currentIndex === 0) {\n               return Promise.reject(new _webreaderError2.default('The current element is the first'));\n            }\n\n            state.currentIndex--;\n\n            return this.readCurrentElement();\n         }\n      }, {\n         key: 'readNextElement',\n         value: function readNextElement() {\n            var state = statusMap.get(this);\n\n            if (state.currentIndex === state.elements.length - 1) {\n               return Promise.reject(new _webreaderError2.default('The current element is the last'));\n            }\n\n            state.currentIndex++;\n\n            return this.readCurrentElement();\n         }\n      }, {\n         key: 'goToLink',\n         value: function goToLink() {\n            var state = statusMap.get(this);\n            var currentElement = state.elements ? state.elements[state.currentIndex] : null;\n\n            if (!currentElement || currentElement.nodeName !== 'A') {\n               return Promise.reject(new _webreaderError2.default('There is not a current link to follow'));\n            }\n\n            window.location.assign(currentElement.href);\n         }\n      }, {\n         key: 'readLinks',\n         value: function readLinks(filters) {\n            var _this4 = this;\n\n            var links = _dom2.default.getLinks(filters);\n\n            statusMap.get(this).elements = links;\n\n            return links.reduce(function (promise, link, index) {\n               promise = promise.then(function () {\n                  statusMap.get(_this4).currentIndex = index;\n\n                  return _this4.readCurrentElement();\n               });\n\n               if (_this4.settings.delay > 0) {\n                  promise = promise.then(function () {\n                     return _timer2.default.wait(_this4.settings.delay);\n                  });\n               }\n\n               return promise;\n            }, Promise.resolve());\n         }\n      }, {\n         key: 'readMain',\n         value: function readMain() {\n            var main = _dom2.default.getMain();\n            var state = statusMap.get(this);\n\n            state.elements = [main];\n            state.currentIndex = 0;\n\n            if (!main) {\n               return Promise.reject(new _webreaderError2.default('The main content of this page cannot be found'));\n            }\n\n            return this.speaker.speak(main.textContent);\n         }\n      }, {\n         key: 'searchMain',\n         value: function searchMain() {\n            var main = _dom2.default.getMain();\n\n            if (!main) {\n               return Promise.reject(new _webreaderError2.default('The main content of this page cannot be found'));\n            }\n\n            var oldTabIndex = main.getAttribute('tabindex');\n\n            main.setAttribute('tabindex', -1);\n            main.addEventListener('blur', function removeTabIndex() {\n               main.removeEventListener('blur', removeTabIndex);\n\n               // Restore tabindex's old value, if any\n               if (oldTabIndex) {\n                  main.setAttribute('tabindex', oldTabIndex);\n               } else {\n                  main.removeAttribute('tabindex');\n               }\n            });\n            main.focus();\n         }\n      }, {\n         key: 'readPageTitle',\n         value: function readPageTitle() {\n            var title = _dom2.default.getTitle();\n\n            if (title) {\n               return this.speaker.speak('The title of the page is ' + title);\n            } else {\n               return this.speaker.speak('This page does not have a title');\n            }\n         }\n      }, {\n         key: 'readPageSummary',\n         value: function readPageSummary() {\n            var headers = _dom2.default.getHeaders();\n            var links = _dom2.default.getLinks();\n\n            return this.speaker.speak('The page contains ' + headers.length + ' headers and ' + links.length + ' links');\n         }\n      }, {\n         key: 'goToPreviousPage',\n         value: function goToPreviousPage() {\n            window.history.back();\n         }\n      }, {\n         key: 'goToNextPage',\n         value: function goToNextPage() {\n            window.history.forward();\n         }\n      }, {\n         key: 'goToHomepage',\n         value: function goToHomepage() {\n            window.location.assign('/');\n         }\n      }]);\n\n      return WebReader;\n   }();\n\n   exports.default = WebReader;\n   module.exports = exports['default'];\n});\n\n},{\"../lang/en-GB.json\":1,\"./commands\":3,\"./dom/dom\":5,\"./helpers/event-emitter\":9,\"./helpers/string-comparers/damerau-levenshtein-comparer\":10,\"./helpers/timer\":12,\"./reader/recognizer\":14,\"./reader/speaker\":15,\"./router\":16,\"./webreader-error\":17}],14:[function(require,module,exports){\n(function (global, factory) {\n   if (typeof define === \"function\" && define.amd) {\n      define('WebReader', ['module', 'exports', '../helpers/event-emitter', '../webreader-error'], factory);\n   } else if (typeof exports !== \"undefined\") {\n      factory(module, exports, require('../helpers/event-emitter'), require('../webreader-error'));\n   } else {\n      var mod = {\n         exports: {}\n      };\n      factory(mod, mod.exports, global.eventEmitter, global.webreaderError);\n      global.WebReader = mod.exports;\n   }\n})(this, function (module, exports, _eventEmitter, _webreaderError) {\n   'use strict';\n\n   Object.defineProperty(exports, \"__esModule\", {\n      value: true\n   });\n\n   var _eventEmitter2 = _interopRequireDefault(_eventEmitter);\n\n   var _webreaderError2 = _interopRequireDefault(_webreaderError);\n\n   function _interopRequireDefault(obj) {\n      return obj && obj.__esModule ? obj : {\n         default: obj\n      };\n   }\n\n   function _classCallCheck(instance, Constructor) {\n      if (!(instance instanceof Constructor)) {\n         throw new TypeError(\"Cannot call a class as a function\");\n      }\n   }\n\n   var _createClass = function () {\n      function defineProperties(target, props) {\n         for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n         }\n      }\n\n      return function (Constructor, protoProps, staticProps) {\n         if (protoProps) defineProperties(Constructor.prototype, protoProps);\n         if (staticProps) defineProperties(Constructor, staticProps);\n         return Constructor;\n      };\n   }();\n\n   /**\n    * @typedef SpeechRecognitionHash\n    * @type {Object}\n    * @property {Object[]} [grammars=[]] The collection of <code>SpeechGrammar</code> objects which represent the grammars\n    * that are active for this recognition\n    * @property {string} [lang=''] The language of the recognition for the request.\n    * If unspecified it defaults to the language of the html document root element\n    * @property {boolean} [continuous=false] Controls whether the interaction is stopped when the user stops speaking or not\n    * @property {boolean} [interimResults=false] Controls whether interim results are returned or not\n    * @property {number} [maxAlternatives=1] The maximum number of <code>SpeechRecognitionAlternative</code>s per result\n    * @property {string} [serviceURI=''] The location of the speech recognition service to use\n    *\n    * @see https://dvcs.w3.org/hg/speech-api/raw-file/tip/webspeechapi.html#speechreco-attributes\n    */\n\n   /**\n    * Retrieves the object that allows to recognize the speech or\n    * <code>null</code> if the feature is not supported\n    *\n    * @returns {SpeechRecognition|null}\n    */\n   function getRecognizer() {\n      return window.SpeechRecognition || window.webkitSpeechRecognition || null;\n   }\n\n   /**\n    * Binds one or more events to a <code>SpeechRecognition</code> object\n    *\n    * @param {SpeechRecognition} recognizer A <code>SpeechRecognition</code> object\n    * @param {Object} eventsHash An object of name-function pairs,\n    * where name is the event to listen and function is the function to attach\n    */\n   function bindEvents(recognizer, eventsHash) {\n      for (var eventName in eventsHash) {\n         recognizer.addEventListener(eventName, eventsHash[eventName]);\n      }\n   }\n\n   /**\n    * Unbinds one or more events to a <code>SpeechRecognition</code> object\n    *\n    * @param {SpeechRecognition} recognizer A <code>SpeechRecognition</code> object\n    * @param {Object} eventsHash An object of name-function pairs,\n    * where name is the event to listen and function is the function to attach\n    */\n   function unbindEvents(recognizer, eventsHash) {\n      for (var eventName in eventsHash) {\n         recognizer.removeEventListener(eventName, eventsHash[eventName]);\n      }\n   }\n\n   /**\n    * The class exposing the reading features of a web page\n    *\n    * @class\n    */\n\n   var Recognizer = function () {\n      /**\n       * Creates a Recognizer instance\n       *\n       * @constructor\n       *\n       * @param {SpeechRecognitionHash} [options={}] The options to customize the settings of the recognizer\n       */\n\n      function Recognizer() {\n         var options = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n         _classCallCheck(this, Recognizer);\n\n         var _Recognizer = getRecognizer();\n\n         if (!_Recognizer) {\n            throw Error('API not supported');\n         }\n\n         /**\n          * The speech recognizer used\n          *\n          * @type {SpeechRecognition}\n          */\n         this.recognizer = new _Recognizer();\n\n         for (var key in options) {\n            if (options.hasOwnProperty(key) && this.recognizer[key] !== undefined) {\n               this.recognizer[key] = options[key];\n            }\n         }\n      }\n\n      /**\n       * Detects if the recognition feature is supported\n       *\n       * @returns {boolean}\n       */\n\n\n      _createClass(Recognizer, [{\n         key: 'recognize',\n         value: function recognize() {\n            var _this = this;\n\n            return new Promise(function (resolve, reject) {\n               var recognizer = _this.recognizer;\n               var eventsHash = {\n                  audiostart: function audiostart() {\n                     _eventEmitter2.default.fireEvent(_eventEmitter2.default.namespace + '.recognitionstart', document);\n                  },\n                  result: function result(event) {\n                     for (var i = event.resultIndex; i < event.results.length; i++) {\n                        if (event.results[i].isFinal) {\n                           var bestGuess = event.results[i][0];\n\n                           _eventEmitter2.default.fireEvent(_eventEmitter2.default.namespace + '.recognitionresult', document, {\n                              data: {\n                                 result: bestGuess\n                              }\n                           });\n\n                           resolve(bestGuess.transcript);\n                        }\n                     }\n                  },\n                  error: function error(event) {\n\n                     _eventEmitter2.default.fireEvent(_eventEmitter2.default.namespace + '.recognitionerror', document, {\n                        error: event.error\n                     });\n\n                     reject(new _webreaderError2.default('An error has occurred while recognizing your speech'));\n                  },\n                  noMatch: function noMatch() {\n\n                     _eventEmitter2.default.fireEvent(_eventEmitter2.default.namespace + '.recognitionnomatch', document);\n\n                     reject(new _webreaderError2.default('Sorry, I could not find a match'));\n                  },\n                  end: function end() {\n\n                     _eventEmitter2.default.fireEvent(_eventEmitter2.default.namespace + '.recognitionend', document);\n\n                     unbindEvents(recognizer, eventsHash);\n\n                     // If the Promise isn't resolved or rejected at this point\n                     // the demo is running on Chrome and Windows 8.1 (issue #428873).\n                     reject(new _webreaderError2.default('Sorry, I could not recognize your speech'));\n                  }\n               };\n\n               bindEvents(_this.recognizer, eventsHash);\n\n               _this.recognizer.start();\n            });\n         }\n      }, {\n         key: 'abort',\n         value: function abort() {\n            this.recognizer.abort();\n         }\n      }], [{\n         key: 'isSupported',\n         value: function isSupported() {\n            return !!getRecognizer();\n         }\n      }]);\n\n      return Recognizer;\n   }();\n\n   exports.default = Recognizer;\n   module.exports = exports['default'];\n});\n\n},{\"../helpers/event-emitter\":9,\"../webreader-error\":17}],15:[function(require,module,exports){\n(function (global, factory) {\n   if (typeof define === \"function\" && define.amd) {\n      define('WebReader', ['module', 'exports', '../helpers/event-emitter', '../webreader-error'], factory);\n   } else if (typeof exports !== \"undefined\") {\n      factory(module, exports, require('../helpers/event-emitter'), require('../webreader-error'));\n   } else {\n      var mod = {\n         exports: {}\n      };\n      factory(mod, mod.exports, global.eventEmitter, global.webreaderError);\n      global.WebReader = mod.exports;\n   }\n})(this, function (module, exports, _eventEmitter, _webreaderError) {\n   'use strict';\n\n   Object.defineProperty(exports, \"__esModule\", {\n      value: true\n   });\n\n   var _eventEmitter2 = _interopRequireDefault(_eventEmitter);\n\n   var _webreaderError2 = _interopRequireDefault(_webreaderError);\n\n   function _interopRequireDefault(obj) {\n      return obj && obj.__esModule ? obj : {\n         default: obj\n      };\n   }\n\n   function _classCallCheck(instance, Constructor) {\n      if (!(instance instanceof Constructor)) {\n         throw new TypeError(\"Cannot call a class as a function\");\n      }\n   }\n\n   var _createClass = function () {\n      function defineProperties(target, props) {\n         for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n         }\n      }\n\n      return function (Constructor, protoProps, staticProps) {\n         if (protoProps) defineProperties(Constructor.prototype, protoProps);\n         if (staticProps) defineProperties(Constructor, staticProps);\n         return Constructor;\n      };\n   }();\n\n   /**\n    * This constant is needed because Chrome doesn't fire an error event\n    * if the <code>cancel()</code> method is called.\n    *\n    * @type {Symbol}\n    */\n   var isCancelledSymbol = Symbol('isCancelled');\n\n   /**\n    * @typedef SpeechSynthesisUtteranceHash\n    * @type {Object}\n    * @property {string} text The text to be synthesized and spoken\n    * @property {string} [lang=''] The language of the speech synthesis for the utterance.\n    * If unspecified it defaults to the language of the html document root element\n    * @property {string} [voice=''] The voice to use\n    * @property {number} [volume=1.0] The speaking volume\n    * @property {number} [rate=1.0] The speaking rate\n    * @property {number} [pitch=1.0] The speaking pitch\n    *\n    * @see {@link https://dvcs.w3.org/hg/speech-api/raw-file/tip/webspeechapi.html#utterance-attributes|SpeechSynthesisUtterance Attributes}\n    */\n\n   /**\n    * Retrieves the object that allows to speech the text or\n    * <code>null</code> if the feature is not supported\n    *\n    * @returns {speechSynthesis|null}\n    */\n   function getSpeaker() {\n      return speechSynthesis || null;\n   }\n\n   /**\n    * Sets the settings for a <code>SpeechSynthesisUtterance</code> object\n    *\n    * @param {SpeechSynthesisUtterance} utterance The object whose settings will be set\n    * @param {SpeechSynthesisUtteranceHash} settings\n    * @param {string[]} voices The voices available\n    */\n   function setUtteranceSettings(utterance, settings, voices) {\n      var _loop = function _loop(key) {\n         if (!settings.hasOwnProperty(key) || utterance[key] === undefined) {\n            return 'continue';\n         }\n\n         if (key !== 'voice') {\n            utterance[key] = settings[key];\n            return 'continue';\n         }\n\n         var voice = voices.filter(function (voice) {\n            return voice.voiceURI === settings[key];\n         }).pop();\n\n         if (voice) {\n            utterance[key] = voice;\n         } else {\n            utterance[key] = voices[0];\n         }\n      };\n\n      for (var key in settings) {\n         var _ret = _loop(key);\n\n         if (_ret === 'continue') continue;\n      }\n   }\n\n   /**\n    * The class exposing the speaking features of a web page\n    *\n    * @class\n    */\n\n   var Speaker = function () {\n      /**\n       * Creates a Speaker instance\n       *\n       * @constructor\n       *\n       * @param {SpeechSynthesisUtteranceHash} [options={}] The options to customize the voice prompting the texts\n       */\n\n      function Speaker() {\n         var options = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n         _classCallCheck(this, Speaker);\n\n         /**\n          *\n          * @type {speechSynthesis|null}\n          */\n         this.speaker = getSpeaker();\n         /**\n          *\n          * @type {SpeechSynthesisUtteranceHash}\n          */\n         this.settings = options;\n         /**\n          *\n          * @type {boolean}\n          */\n         this[isCancelledSymbol] = false;\n\n         if (!this.speaker) {\n            throw Error('API not supported');\n         }\n      }\n\n      /**\n       * Detects if the speech feature is supported\n       *\n       * @returns {boolean}\n       */\n\n\n      _createClass(Speaker, [{\n         key: 'getVoices',\n         value: function getVoices() {\n            var _this = this;\n\n            return new Promise(function (resolve) {\n               var voices = _this.speaker.getVoices();\n\n               if (voices.length > 1) {\n                  return resolve(voices);\n               } else {\n                  (function () {\n                     var onVoicesChanged = function () {\n                        resolve(this.speaker.getVoices());\n\n                        getSpeaker().removeEventListener('voiceschanged', onVoicesChanged);\n                     }.bind(_this);\n\n                     getSpeaker().addEventListener('voiceschanged', onVoicesChanged);\n                  })();\n               }\n            });\n         }\n      }, {\n         key: 'speak',\n         value: function speak(text) {\n            var _this2 = this;\n\n            return this.getVoices().then(function (voices) {\n               return new Promise(function (resolve, reject) {\n                  var utterance = new window.SpeechSynthesisUtterance(text);\n                  var eventData = Object.assign({ text: text }, _this2.settings);\n\n                  setUtteranceSettings(utterance, _this2.settings, voices);\n\n                  utterance.addEventListener('start', function () {\n\n                     _eventEmitter2.default.fireEvent(_eventEmitter2.default.namespace + '.synthesisstart', document, {\n                        data: eventData\n                     });\n                  });\n\n                  utterance.addEventListener('end', function () {\n\n                     _eventEmitter2.default.fireEvent(_eventEmitter2.default.namespace + '.synthesisend', document, {\n                        data: eventData\n                     });\n\n                     if (_this2[isCancelledSymbol]) {\n                        _this2[isCancelledSymbol] = false;\n                        return reject({\n                           error: 'interrupted'\n                        });\n                     }\n\n                     resolve();\n                  });\n\n                  utterance.addEventListener('error', function (event) {\n\n                     _eventEmitter2.default.fireEvent(_eventEmitter2.default.namespace + '.synthesiserror', document, {\n                        data: eventData\n                     });\n\n                     reject(new _webreaderError2.default('An error has occurred while speaking'));\n                  });\n\n                  _this2.speaker.speak(utterance);\n               });\n            });\n         }\n      }, {\n         key: 'cancel',\n         value: function cancel() {\n            this.speaker.cancel();\n            this[isCancelledSymbol] = true;\n         }\n      }], [{\n         key: 'isSupported',\n         value: function isSupported() {\n            return !!getSpeaker();\n         }\n      }]);\n\n      return Speaker;\n   }();\n\n   exports.default = Speaker;\n   module.exports = exports['default'];\n});\n\n},{\"../helpers/event-emitter\":9,\"../webreader-error\":17}],16:[function(require,module,exports){\n(function (global, factory) {\n   if (typeof define === \"function\" && define.amd) {\n      define('WebReader', ['module', 'exports', './webreader-error'], factory);\n   } else if (typeof exports !== \"undefined\") {\n      factory(module, exports, require('./webreader-error'));\n   } else {\n      var mod = {\n         exports: {}\n      };\n      factory(mod, mod.exports, global.webreaderError);\n      global.WebReader = mod.exports;\n   }\n})(this, function (module, exports, _webreaderError) {\n   'use strict';\n\n   Object.defineProperty(exports, \"__esModule\", {\n      value: true\n   });\n\n   var _webreaderError2 = _interopRequireDefault(_webreaderError);\n\n   function _interopRequireDefault(obj) {\n      return obj && obj.__esModule ? obj : {\n         default: obj\n      };\n   }\n\n   function _classCallCheck(instance, Constructor) {\n      if (!(instance instanceof Constructor)) {\n         throw new TypeError(\"Cannot call a class as a function\");\n      }\n   }\n\n   var _createClass = function () {\n      function defineProperties(target, props) {\n         for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n         }\n      }\n\n      return function (Constructor, protoProps, staticProps) {\n         if (protoProps) defineProperties(Constructor.prototype, protoProps);\n         if (staticProps) defineProperties(Constructor, staticProps);\n         return Constructor;\n      };\n   }();\n\n   var Router = function () {\n      function Router() {\n         _classCallCheck(this, Router);\n      }\n\n      _createClass(Router, null, [{\n         key: 'route',\n         value: function route(webReader, recognizedCommand) {\n            /* jshint -W074 */\n            if (recognizedCommand.command === 'READ_ALL_HEADERS') {\n               return webReader.readHeaders();\n            } else if (recognizedCommand.command === 'READ_ALL_LINKS') {\n               return webReader.readLinks();\n            } else if (recognizedCommand.command === 'READ_LEVEL_HEADERS') {\n               return webReader.readHeaders({\n                  level: recognizedCommand.level\n               });\n            } else if (recognizedCommand.command === 'READ_MAIN') {\n               return webReader.readMain();\n            } else if (recognizedCommand.command === 'SEARCH_MAIN') {\n               return webReader.searchMain();\n            } else if (recognizedCommand.command === 'READ_AGAIN') {\n               return webReader.readCurrentElement();\n            } else if (recognizedCommand.command === 'READ_PREVIOUS') {\n               return webReader.readPreviousElement();\n            } else if (recognizedCommand.command === 'READ_NEXT') {\n               return webReader.readNextElement();\n            } else if (recognizedCommand.command === 'READ_PAGE_TITLE') {\n               return webReader.readPageTitle();\n            } else if (recognizedCommand.command === 'READ_LINKS_IN_ELEMENT') {\n               return webReader.readLinks({\n                  ancestor: recognizedCommand.element\n               });\n            } else if (recognizedCommand.command === 'GO_TO_PREVIOUS_PAGE') {\n               return webReader.goToPreviousPage();\n            } else if (recognizedCommand.command === 'GO_TO_NEXT_PAGE') {\n               return webReader.goToNextPage();\n            } else if (recognizedCommand.command === 'READ_PAGE_SUMMARY') {\n               return webReader.readPageSummary();\n            } else if (recognizedCommand.command === 'GO_TO_HOMEPAGE') {\n               return webReader.goToHomepage();\n            } else if (recognizedCommand.command === 'GO_TO_LINK') {\n               return webReader.goToLink();\n            } else {\n               throw new _webreaderError2.default('The command is not supported');\n            }\n         }\n      }]);\n\n      return Router;\n   }();\n\n   exports.default = Router;\n   module.exports = exports['default'];\n});\n\n},{\"./webreader-error\":17}],17:[function(require,module,exports){\n(function (global, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    define(\"WebReader\", [\"module\", \"exports\"], factory);\n  } else if (typeof exports !== \"undefined\") {\n    factory(module, exports);\n  } else {\n    var mod = {\n      exports: {}\n    };\n    factory(mod, mod.exports);\n    global.WebReader = mod.exports;\n  }\n})(this, function (module, exports) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  var WebReaderError =\n  /**\n   * Creates an instance of WebReaderError\n   *\n   * @constructor\n   *\n   * @param {string} message The message of the error\n   */\n  function WebReaderError(message) {\n    _classCallCheck(this, WebReaderError);\n\n    /**\n     * The name of error\n     *\n     * @type {string} WebReaderError\n     */\n    this.name = this.constructor.name;\n    /**\n     * The message describing the error\n     *\n     * @type {string}\n     */\n    this.message = message;\n  };\n\n  exports.default = WebReaderError;\n  module.exports = exports['default'];\n});\n\n},{}]},{},[13])(13)\n});\n\n","function DamerauLevenshtein (prices, damerau) {\n    // 'prices' customisation of the edit costs by passing an\n    // object with optional 'insert', 'remove', 'substitute', and\n    // 'transpose' keys, corresponding to either a constant\n    // number, or a function that returns the cost. The default\n    // cost for each operation is 1. The price functions take\n    // relevant character(s) as arguments, should return numbers,\n    // and have the following form:\n    //\n    // insert: function (inserted) { return NUMBER; }\n    //\n    // remove: function (removed) { return NUMBER; }\n    //\n    // substitute: function (from, to) { return NUMBER; }\n    //\n    // transpose: function (backward, forward) { return NUMBER; }\n    //\n    // The damerau flag allows us to turn off transposition and\n    // only do plain Levenshtein distance.\n\n    if (damerau !== false) damerau = true;\n    if (!prices) prices = {};\n    var insert, remove, substitute, transpose;\n\n    switch (typeof prices.insert) {\n    case 'function': insert = prices.insert; break;\n    case 'number': insert = function (c) { return prices.insert; }; break;\n    default: insert = function (c) { return 1; }; break; }\n\n    switch (typeof prices.remove) {\n    case 'function': remove = prices.remove; break;\n    case 'number': remove = function (c) { return prices.remove; }; break;\n    default: remove = function (c) { return 1; }; break; }\n\n    switch (typeof prices.substitute) {\n    case 'function': substitute = prices.substitute; break;\n    case 'number':\n        substitute = function (from, to) { return prices.substitute; };\n        break;\n    default: substitute = function (from, to) { return 1; }; break; }\n\n    switch (typeof prices.transpose) {\n    case 'function': transpose = prices.transpose; break;\n    case 'number':\n        transpose = function (backward, forward) { return prices.transpose; };\n        break;\n    default: transpose = function (backward, forward) { return 1; }; break; }\n\n    function distance(down, across) {\n        // http://en.wikipedia.org/wiki/Damerau%E2%80%93Levenshtein_distance\n        var ds = [];\n        if ( down === across ) {\n            return 0;\n        } else {\n            down = down.split(''); down.unshift(null);\n            across = across.split(''); across.unshift(null);\n            down.forEach(function (d, i) {\n                if (!ds[i]) ds[i] = [];\n                across.forEach(function (a, j) {\n                    if (i === 0 && j === 0) ds[i][j] = 0;\n                    // Empty down (i == 0) -> across[1..j] by inserting\n                    else if (i === 0) ds[i][j] = ds[i][j-1] + insert(a);\n                    // Down -> empty across (j == 0) by deleting\n                    else if (j === 0) ds[i][j] = ds[i-1][j] + remove(d);\n                    else {\n                        // Find the least costly operation that turns\n                        // the prefix down[1..i] into the prefix\n                        // across[1..j] using already calculated costs\n                        // for getting to shorter matches.\n                        ds[i][j] = Math.min(\n                            // Cost of editing down[1..i-1] to\n                            // across[1..j] plus cost of deleting\n                            // down[i] to get to down[1..i-1].\n                            ds[i-1][j] + remove(d),\n                            // Cost of editing down[1..i] to\n                            // across[1..j-1] plus cost of inserting\n                            // across[j] to get to across[1..j].\n                            ds[i][j-1] + insert(a),\n                            // Cost of editing down[1..i-1] to\n                            // across[1..j-1] plus cost of\n                            // substituting down[i] (d) with across[j]\n                            // (a) to get to across[1..j].\n                            ds[i-1][j-1] + (d === a ? 0 : substitute(d, a))\n                        );\n                        // Can we match the last two letters of down\n                        // with across by transposing them? Cost of\n                        // getting from down[i-2] to across[j-2] plus\n                        // cost of moving down[i-1] forward and\n                        // down[i] backward to match across[j-1..j].\n                        if (damerau\n                            && i > 1 && j > 1\n                            && down[i-1] === a && d === across[j-1]) {\n                            ds[i][j] = Math.min(\n                                ds[i][j],\n                                ds[i-2][j-2] + (d === a ? 0 : transpose(d, down[i-1]))\n                            );\n                        };\n                    };\n                });\n            });\n            return ds[down.length-1][across.length-1];\n        };\n    };\n    return distance;\n};\n\nmodule.exports = DamerauLevenshtein;\n","import StringComparer from './helpers/string-comparers/string-comparer';\n\n/**\n * The translation currently in use\n *\n * @type {Object}\n */\nlet translation = null;\n\n/**\n * @typedef CommandsHash\n * @type {Object}\n * @property {string} command The command recognized\n * @property {string} [translationsPath=''] The path to the translations folder\n * @property {Object} [recognizer] The settings for the speech recognition functionality\n */\n\n/**\n * Extracts the heading level contained in the string provided.\n * If a perfect match is not found, the Damerau-Levenshtein algorithm\n * is used to find the closest match.\n *\n * @param {StringComparer} StringComparer The comparer to use for comparing strings\n * @param {string} recognizedText The string to analyze\n *\n * @return {Object}\n */\nfunction extractHeaderLevel(StringComparer, recognizedText) {\n   const headingLevels = translation.commands.READ_LEVEL_HEADERS.levels;\n   let data = {};\n\n   for(let i = 0; i < headingLevels.length; i++) {\n      let regexp = new RegExp(`(^|\\\\b)(${i + 1}|h${i + 1}|${headingLevels[i]})(\\\\b|$)`, 'i');\n\n      if (regexp.test(recognizedText)) {\n         data.level = i + 1;\n         break;\n      }\n   }\n\n   // If the header level has not been found yet,\n   // let's try a more heuristic strategy\n   if (!data.level) {\n      let closerMatchIndex = StringComparer.findCloserMatch(headingLevels, recognizedText).index;\n\n      data.level = closerMatchIndex === -1 ? -1 : closerMatchIndex + 1;\n   }\n\n   return data;\n}\n\n/**\n * Searches an element type, such as <code>main</code> or <code>footer</code>,\n * in the text provided. If none is found, <code>null</code> is returned\n *\n * @param {string} recognizedText The string to analyze\n *\n * @return {HTMLElement|null}\n */\nfunction findElementInText(recognizedText) {\n   let elements = translation.elements;\n   let foundElement = null;\n\n   for(let key in elements) {\n      let variations = elements[key].variations.join('|');\n      let regexp = new RegExp(`(^|\\\\b)(${variations})(\\\\b|$)`, 'i');\n\n      if (regexp.test(recognizedText)) {\n         foundElement = document.querySelector(elements[key].selector);\n         break;\n      }\n   }\n\n   return foundElement;\n}\n/**\n * Searches an element type, such as <code>main</code> or <code>footer</code>,\n * in the text provided. If none is found, the closest match is re is returned\n *\n * @param {StringComparer} StringComparer The comparer to use for comparing strings\n * @param {string} recognizedText The string to analyze\n *\n * @return {Object}\n */\nfunction extractElementFromText(StringComparer, recognizedText) {\n   let foundElement = findElementInText(recognizedText);\n\n   if (foundElement) {\n      return {\n         element: foundElement\n      };\n   }\n\n   // Collects the closer match for each element.\n   let closerMatches = [];\n   let elements = translation.elements;\n\n   // If the element has not been found yet,\n   // let's try a more heuristic strategy\n   for(let key in elements) {\n      let variations = elements[key].variations;\n      let closerMatchIndex = StringComparer.findCloserMatch(variations, recognizedText);\n\n      if (closerMatchIndex !== -1) {\n         closerMatches.push(variations[closerMatchIndex]);\n      }\n   }\n\n   // Find the closest match among the closest match\n   let closestMatch = StringComparer.findCloserMatch(closerMatches, recognizedText);\n\n   return {\n      element: closestMatch.index >= 0 ? closerMatches[closestMatch.index] : null\n   };\n}\n\n/**\n * Extracts relevant data from a string, based on the recognized command\n *\n * @param {StringComparer} StringComparer The comparer to use for comparing strings\n * @param {string} command The recognized command\n * @param {string} recognizedText The string from which the data are extracted\n *\n * @return {Object}\n */\nfunction extractData(StringComparer, command, recognizedText) {\n   let data = {};\n\n   if (command === 'READ_LEVEL_HEADERS') {\n      console.debug('Extracting header level from text');\n      data = extractHeaderLevel(StringComparer, recognizedText);\n   } else if (command === 'READ_LINKS_IN_ELEMENT') {\n      console.debug('Extracting element from text');\n      data = extractElementFromText(StringComparer, recognizedText);\n   }\n\n   return data;\n}\n\n/**\n * The class responsible for the commands\n *\n * @class\n */\nexport\n   default class Commands {\n   /**\n    * Creates an instance of Commands\n    *\n    * @constructor\n    *\n    * @param {StringComparer} Comparer The class representing the strategy to adopt to compare strings\n    */\n   constructor(Comparer) {\n      if (!(Comparer.prototype instanceof StringComparer)) {\n         throw new TypeError(`${arguments[0]} is not an instance of StringComparer`);\n      }\n\n      Object.defineProperty(this, 'StringComparer', {\n         enumerable: false,\n         configurable: false,\n         get: function() {\n            return Comparer;\n         }\n      });\n   }\n\n   /**\n    * Detects the action to perform and extracts any relevant data\n    * based on the string provided\n    *\n    * @param {string} recognizedText The string to analyze\n    * @param {Object} currentTranslation The object containing the translation of the application\n    *\n    * @return {CommandsHash}\n    */\n   recognizeCommand(recognizedText, currentTranslation) {\n      let minDistance = Number.POSITIVE_INFINITY;\n      let commands = currentTranslation.commands;\n      let foundCommand;\n\n      translation = currentTranslation;\n      recognizedText = recognizedText.toLocaleLowerCase();\n\n      console.debug('Command recognition started');\n\n      for(let command in commands) {\n         let closerMatch = this.StringComparer.findCloserMatch(\n            [commands[command].text].concat(commands[command].variations),\n            recognizedText\n         );\n\n         if (closerMatch.distance < minDistance) {\n            foundCommand = Object.assign({\n               command\n            }, extractData(this.StringComparer, command, recognizedText));\n\n            if (closerMatch.distance === 0) {\n               break;\n            } else {\n               minDistance = closerMatch.distance;\n            }\n         }\n      }\n\n      console.debug(`Command recognition ended. Found command \"${commands[foundCommand.command].text}\"`);\n      console.debug('Extrapolated data:', foundCommand);\n\n      return foundCommand;\n   }\n}","/**\n * Returns the title of the current document\n *\n * @return {string}\n */\nfunction getTitle() {\n   return document.title;\n}\n\nexport {\n   getTitle\n}","import {getTitle} from './document'\nimport {getHeaders} from './headers'\nimport {getLinks} from './links'\nimport {getMain} from './main'\n\n/**\n * Highlights an element in the current document by wrapping it\n * with a <code>mark</code> element\n *\n * @param {HTMLElement} element The element to highlight\n */\nfunction highlightElement(element) {\n   if (!element instanceof HTMLElement) {\n      return;\n   }\n\n   element.innerHTML = `<mark>${element.innerHTML}</mark>`;\n}\n\n/**\n * Unhighlights an element in the current document by removing\n * the <code>mark</code> element wrapping it\n *\n * @param {HTMLElement} element The element to unhighlight\n */\nfunction unhighlightElement(element) {\n   if (!element instanceof HTMLElement) {\n      return;\n   }\n\n   element.innerHTML = element.innerHTML\n      .replace(/^<mark>/, '')\n      .replace(/<\\/mark>$/, '');\n}\n\nexport default {\n   getHeaders,\n   getLinks,\n   getMain,\n   getTitle,\n   highlightElement,\n   unhighlightElement\n};","/**\n * Returns the level of a header (1 for an <code>h1</code>, 2 for an <code>h2</code>,\n * and so on). If the element is not an header or it is not defined, zero is returned\n *\n * @param {HTMLElement} element\n *\n * @return {number}\n */\nfunction getHeaderLevel(element) {\n   if (!element || !element.nodeName || element.nodeName.toLowerCase().indexOf('h') !== 0) {\n      return 0;\n   }\n\n   return parseInt(element.nodeName.charAt(1), 10);\n}\n\n/**\n * Returns all the headers of a page in a tree structure. Each element\n * possesses two properties: element and subheadings. The former\n * is an <code>HTMLElement</code> referencing the header, while the latter is an array\n * containing all the subheadings of the header.\n *\n * @return {Object[]}\n */\nfunction createHeadingsStructure(headers) {\n   let tree = [];\n\n   (function recurse(headers, index, tree) {\n      if (headers.length === 0 || index.index === headers.length) {\n         return tree;\n      }\n\n      let headerLevel = getHeaderLevel(headers[index.index]);\n      let header = {\n         element: headers[index.index],\n         subheadings: []\n      };\n\n      if (tree.length === 0 || headerLevel === getHeaderLevel(tree[tree.length - 1].element)) {\n         tree.push(header);\n         index.index++;\n\n         return recurse(headers, index, tree);\n      }\n\n      if (headerLevel > getHeaderLevel(tree[tree.length - 1].element)) {\n         tree[tree.length - 1].subheadings = recurse(headers, index, []);\n      }\n\n      headerLevel = getHeaderLevel(headers[index.index]);\n\n      if (headerLevel === getHeaderLevel(tree[tree.length - 1].element)) {\n         return recurse(headers, index, tree);\n      } else {\n         return tree;\n      }\n   })(headers, {index: 0}, tree);\n}\n\n/**\n * Returns all the headers of a page, optionally filtered\n *\n * @param {Object} [filters={}] An object used to filters the headers to return\n * @param {number} [filters.level=-1] An integer that specifies the level to retrieve.\n * If set  to -1 retrieves all the headers\n * @param {string} [filters.text=''] A string that must be contained in the header's text\n *\n * @return {HTMLElement[]}\n */\nfunction getHeaders(filters = {}) {\n   let selector;\n\n   filters = Object.assign(\n      {\n         level: -1,\n         text: ''\n      },\n      filters\n   );\n\n   if (filters.level === -1) {\n      selector = 'h1, h2, h3, h4, h5, h6';\n   } else {\n      selector = `h${filters.level}`;\n   }\n\n   let filterTextRegExp = new RegExp(`(^|\\\\b)${filters.text}(\\\\b|$)`, 'i');\n   let headers = Array\n      .from(document.querySelectorAll(selector))\n      .filter(header => header.textContent.search(filterTextRegExp) >= 0);\n\n   return headers;\n}\n\nexport {\n   createHeadingsStructure,\n   getHeaders\n}","/**\n * Determines if a link would be read or not by a classic screen reader\n *\n * @param {HTMLElement} element The element to test\n *\n * @return {boolean}\n */\nfunction isScreenReaderVisible(element) {\n   return window.getComputedStyle(element).display !== 'none' &&\n          element.getAttribute('aria-hidden') !== 'true';\n}\n\n/**\n * Returns all the links of a page, optionally filtered\n *\n * @param {Object} [filters={}] An object used to filters the links\n * @param {(HTMLElement|HTMLDocument)} [filters.ancestor=document] The ancestor of the links to retrieve\n *\n * @return {HTMLElement[]}\n */\nfunction getLinks(filters = {}) {\n   filters = Object.assign(\n      {\n         ancestor: document\n      },\n      filters\n   );\n\n   let links = filters.ancestor.querySelectorAll('a');\n\n   return Array\n      .from(links)\n      .filter(element => isScreenReaderVisible(element));\n}\n\nexport {\n   getLinks\n}","/**\n * Returns the main element of the page.\n * If the element is not found, an heuristic is employed to find a possible\n * main element. If the heuristic approach fails, <code>null</code> is returned\n *\n * @return {HTMLElement|null}\n */\nfunction getMain() {\n   let main = document.querySelector('main') ||\n              document.querySelector('[role=\"main\"]');\n\n   // If a main has not been found, let's use an heuristic to find\n   // a possible main content that has not been marked as such.\n   if (!main) {\n      let possibleMain = document.querySelectorAll('#main-content, .main-content, #main, .main');\n\n      // If only one element is found, it's highly possible\n      // that it's the true main content of the page.\n      if (possibleMain.length === 1) {\n         main = possibleMain[0];\n      }\n   }\n\n   return main;\n}\n\nexport {\n   getMain\n}","/**\n * The class representing an event emitter\n *\n * @class\n */\nexport\n   default class EventEmitter {\n   /**\n    * Returns the namespace of the events\n    *\n    * @return {string}\n    */\n   static get namespace() {\n      return 'webreader';\n   }\n\n   /**\n    * Namespaces an event\n    *\n    * @param {string} eventName The event name\n    *\n    * @return {string}\n    */\n   static namespaceEvent(eventName) {\n      return `${EventEmitter.namespace}.${eventName}`;\n   }\n\n   /**\n    * Fires an event\n    *\n    * @param {string} eventName The name of the event\n    * @param {HTMLElement|Document} element The element on which the event is dispatched\n    * @param {Object} [properties] A set of key-values to assign to the event\n    */\n   static fireEvent(eventName, element, properties) {\n      let customEvent = document.createEvent('Event');\n\n      customEvent.initEvent(eventName, true, true);\n\n      for (let property in properties) {\n         if (properties.hasOwnProperty(property)) {\n            try {\n               customEvent[property] = properties[property];\n            } catch (ex) {\n               console.debug(`Properties ${property} cannot be copied`);\n            }\n         }\n      }\n\n      element.dispatchEvent(customEvent);\n   }\n}","import DamerauLevenshtein from 'damerau-levenshtein';\nimport StringComparer from './string-comparer';\n\n/**\n * The class representing a comparer using the Damerau-Levenshtein algorithm\n *\n * @class\n */\nexport\n   default class DamerauLevenshteinComparer extends StringComparer {\n   /**\n    * Finds the closest match of a string using the Damerau-Levenshtein algorithm\n    *\n    * @param {(string|string[])} string The string or the array of strings to test\n    * @param {string} target The string to test against\n    *\n    * @return {Object}\n    */\n   static findCloserMatch(string, target) {\n      if (!Array.isArray(string)) {\n         string = [string];\n      }\n\n      let damerauLevenshtein = DamerauLevenshtein(); // jshint ignore:line\n      let minDistance = Number.POSITIVE_INFINITY;\n      let i;\n\n      for(i = 0; i < string.length; i++) {\n         let distance = damerauLevenshtein(string[i], target);\n\n         console.debug(`The distance between \"${string[i]}\" and \"${target}\" is ${distance}`);\n\n         // If a perfect match is found, exit immediately\n         if (distance === 0) {\n            minDistance = distance;\n            break;\n         } else if (distance < minDistance) {\n            minDistance = distance;\n         }\n      }\n\n      return {\n         index: i === string.length ? -1 : i,\n         distance: minDistance\n      };\n   }\n}","/**\n * An interface representing a string comparer\n *\n * @interface\n */\nexport\n   default class StringComparer {\n      /**\n       * Finds the closest match of a string\n       *\n       * @abstract\n       *\n       * @param {(string|string[])} string The string or the array of strings to test\n       * @param {string} target The string to test against\n       *\n       * @return {Object}\n       */\n      static findCloserMatch(string, target) {\n         throw new Error(`The ${arguments.callee.name} function must be overridden`);\n      }\n   }\n","/**\n * The class representing a timer\n *\n * @class\n */\nexport\n   default class Timer {\n   /**\n    * Waits for the amount of milliseconds specified\n    *\n    * @param {number} milliseconds The amount of milliseconds to wait\n    *\n    * @return {Promise}\n    */\n   static wait(milliseconds) {\n      return new Promise(resolve => window.setTimeout(resolve, milliseconds));\n   }\n}","import Commands from './commands';\nimport Dom from './dom/dom';\nimport Recognizer from './reader/recognizer';\nimport Router from './router';\nimport Speaker from './reader/speaker';\nimport EventEmitter from './helpers/event-emitter';\nimport DamerauLevenshteinComparer from './helpers/string-comparers/damerau-levenshtein-comparer';\nimport Timer from './helpers/timer';\nimport WebReaderError from './webreader-error';\nimport defaultTranslation from '../lang/en-GB.json';\n\nconst defaultLanguage = 'en-GB';\n\n/**\n * @typedef SettingsHash\n * @type {Object}\n * @property {number} [delay=300] The delay between each spoken text\n * @property {string} [translationsPath=''] The path to the translations folder\n * @property {SpeechRecognitionHash} [recognizer] The settings for the speech recognition functionality\n * @property {SpeechSynthesisUtteranceHash} [speaker] The settings for the speech synthesis functionality\n * functionality\n */\n\n/**\n * The default values for the settings available\n *\n * @type {SettingsHash}\n */\nconst defaults = {\n   delay: 300,\n   translationsPath: '',\n   recognizer: {\n      lang: defaultLanguage\n   },\n   speaker: {\n      lang: defaultLanguage,\n      voice: 'Google UK English Female'\n   }\n};\n\nconst defaultState = {\n   isInteracting: false,\n   elements: null,\n   currentIndex: -1\n};\n\nlet eventListenersMap = new WeakMap();\nlet statusMap = new WeakMap();\nlet translations = new Map([[defaultLanguage, defaultTranslation]]);\n\n/**\n * Downloads a translation for the commands available\n *\n * @param {string} translationsPath The path to the translations folder\n * @param {string} language The language to download\n *\n * @return {Promise}\n */\nfunction downloadTranslation(translationsPath, language) {\n   return window\n      .fetch(`${translationsPath}/${language}.json`)\n      .then(response => response.json())\n      .then(response => {\n         translations.set(language, response);\n\n         return response;\n      });\n}\n\n/**\n * Performs certain actions based on the shortcuts pressed by the user\n *\n * @param {WebReader} webReader An instance of WebReader\n * @param {Event} event An event\n */\nfunction listenShortcuts(webReader, event) {\n   if (\n      event.ctrlKey === true &&\n      (event.code && event.code === 'Space' || event.which === 32)\n   ) {\n      if (webReader.isInteracting()) {\n         let state = statusMap.get(webReader);\n\n         if (state.elements) {\n            Dom.unhighlightElement(state.elements[state.currentIndex]);\n         }\n\n         webReader.stopCommand();\n      } else {\n         webReader.receiveCommand();\n      }\n   }\n}\n\n/**\n * The class representing the library\n *\n * @class\n */\nexport\n   default class WebReader {\n   /**\n    * Creates an instance of WebReader\n    *\n    * @constructor\n    *\n    * @param {SettingsHash} [options={}] The options to customize WebReader\n    */\n   constructor(options = {}) {\n      /**\n       * @type {Object}\n       */\n      this.settings = Object.assign({}, defaults, options);\n      /**\n       *\n       * @type {Recognizer}\n       */\n      this.recognizer = new Recognizer(this.settings.recognizer);\n      /**\n       *\n       * @type {Speaker}\n       */\n      this.speaker = new Speaker(this.settings.speaker);\n\n      statusMap.set(this, Object.assign({}, defaultState));\n      eventListenersMap.set(this, new Map());\n\n      let language = this.settings.recognizer.lang;\n\n      if (language && !translations.has(language)) {\n         downloadTranslation(this.settings.translationsPath, language)\n            .then(\n               () => {\n                  let message = `Language \"${language}\" successfully loaded`;\n\n                  console.debug(message);\n\n                  EventEmitter.fireEvent(`${EventEmitter.namespace}.languagedownload`, document, {\n                     data: {\n                        lang: language\n                     }\n                  });\n\n                  return this.speaker.speak(message);\n               },\n               err => {\n                  console.debug(err.message);\n\n                  EventEmitter.fireEvent(`${EventEmitter.namespace}.languageerror`, document, {\n                     data: {\n                        lang: language\n                     }\n                  });\n\n                  return this.speaker.speak(`An error occurred: the language \"${language}\" was not loaded`);\n               }\n            );\n      }\n   }\n\n   /**\n    * Determines if WebReader is currently interacting with the user\n    *\n    * @return {boolean}\n    */\n   isInteracting() {\n      return statusMap.get(this).isInteracting;\n   }\n\n   /**\n    * Enables the keyboard shortcuts provided\n    *\n    * @return {WebReader}\n    */\n   enableShortcuts() {\n      let eventListeners = eventListenersMap.get(this);\n\n      eventListeners.set('keydown', listenShortcuts.bind(this, this));\n\n      document.documentElement.addEventListener('keydown', eventListeners.get('keydown'));\n\n      return this;\n   }\n\n   /**\n    * Disables the keyboard shortcuts provided\n    *\n    * @return {WebReader}\n    */\n   disableShortcuts() {\n      let eventListeners = eventListenersMap.get(this);\n\n      document.documentElement.removeEventListener('keydown', eventListeners.get('keydown'));\n      eventListeners.delete('keydown');\n\n      return this;\n   }\n\n   /**\n    * Starts the interaction with the user to receive a vocal command.\n    * If a supported command is recognized, the required action is executed.\n    *\n    * @return {Promise}\n    */\n   receiveCommand() {\n      statusMap.get(this).isInteracting = true;\n      console.debug('Interaction started');\n\n      EventEmitter.fireEvent(`${EventEmitter.namespace}.interactionstart`, document);\n\n      return this.speaker\n         .speak('Ready')\n         .then(() => this.recognizer.recognize())\n         .then(recognizedText => {\n            let commands = new Commands(DamerauLevenshteinComparer);\n            let translation = translations.get(this.settings.recognizer.lang);\n\n            return commands.recognizeCommand(recognizedText, translation);\n         })\n         .then(recognizedCommand => Router.route(this, recognizedCommand))\n         .catch(error => {\n            if (error instanceof WebReaderError) {\n               return this.speaker.speak(error.message);\n            }\n\n            if (error.error !== 'aborted' && error.error !== 'interrupted') {\n               console.debug('An error occurred', error);\n\n               statusMap.set(this, Object.assign({}, defaultState));\n\n               return this.speaker.speak('Sorry, I could not recognize the command');\n            }\n         })\n         .then(// Simulate an always() method\n            () => {},\n            () => {}\n         )\n         .then(() => {\n            statusMap.get(this).isInteracting = false;\n            console.debug('Interaction completed');\n\n            EventEmitter.fireEvent(`${EventEmitter.namespace}.interactionend`, document);\n         });\n   }\n\n   /**\n    * Stops the interaction\n    */\n   stopCommand() {\n      this.recognizer.abort();\n      this.speaker.cancel();\n      statusMap.get(this).isInteracting = false;\n      console.debug('Interaction stopped');\n   }\n\n   /**\n    * Reads all the headers of a page, optionally filtered\n    *\n    * @param {Object} [filters={}] The filters to apply\n    * @param {number} [filters.level=-1] The level of the headers to read\n    * (e.g. 1 means read all and only the H1 on the page).\n    * If -1 is provided, all the headers are read\n    *\n    * @return {Promise}\n    */\n   readHeaders(filters = {}) {\n      let headers = Dom.getHeaders(filters);\n      let level = filters && filters.level ? filters.level : -1;\n\n      statusMap.get(this).elements = headers;\n\n      return headers.reduce((promise, header, index) => {\n         promise = promise.then(() => {\n            statusMap.get(this).currentIndex = index;\n            Dom.highlightElement(header);\n\n            return this.speaker\n               .speak(header.textContent + (level !== -1 ? '' : ` ${header.nodeName}`))\n               .then(() => Dom.unhighlightElement(header))\n               .catch(error => {\n                  Dom.unhighlightElement(header);\n\n                  return Promise.reject(error);\n               });\n         });\n\n         if (this.settings.delay > 0) {\n            promise = promise.then(() => Timer.wait(this.settings.delay));\n         }\n\n         return promise;\n      }, Promise.resolve());\n   }\n\n   /**\n    * Reads again the last element processed\n    *\n    * @return {Promise}\n    */\n   readCurrentElement() {\n      let state = statusMap.get(this);\n\n      if (!state.elements) {\n         return Promise.reject(new WebReaderError('There is not a current element to read'));\n      }\n\n      let element = state.elements[state.currentIndex];\n\n      Dom.highlightElement(element);\n\n      return this.speaker\n         .speak(element.textContent)\n         .then(() => Dom.unhighlightElement(element))\n         .catch(error => {\n            Dom.unhighlightElement(element);\n\n            return Promise.reject(error);\n         });\n   }\n\n   /**\n    * Reads the previous element\n    *\n    * @return {Promise}\n    */\n   readPreviousElement() {\n      let state = statusMap.get(this);\n\n      if (state.currentIndex === 0) {\n         return Promise.reject(new WebReaderError('The current element is the first'));\n      }\n\n      state.currentIndex--;\n\n      return this.readCurrentElement();\n   }\n\n   /**\n    * Reads the next element\n    *\n    * @return {Promise}\n    */\n   readNextElement() {\n      let state = statusMap.get(this);\n\n      if (state.currentIndex === state.elements.length - 1) {\n         return Promise.reject(new WebReaderError('The current element is the last'));\n      }\n\n      state.currentIndex++;\n\n      return this.readCurrentElement();\n   }\n\n   /**\n    * Follows the last read link\n    */\n   goToLink() {\n      let state = statusMap.get(this);\n      let currentElement = state.elements ? state.elements[state.currentIndex] : null;\n\n      if (!currentElement || currentElement.nodeName !== 'A') {\n         return Promise.reject(new WebReaderError('There is not a current link to follow'));\n      }\n\n      window.location.assign(currentElement.href);\n   }\n\n   /**\n    * Reads all the links of a page\n    *\n    * @param {Object} [filters={}] An object used to filters the links\n    *\n    * @return {Promise}\n    */\n   readLinks(filters) {\n      let links = Dom.getLinks(filters);\n\n      statusMap.get(this).elements = links;\n\n      return links.reduce((promise, link, index) => {\n         promise = promise.then(() => {\n            statusMap.get(this).currentIndex = index;\n\n            return this.readCurrentElement();\n         });\n\n         if (this.settings.delay > 0) {\n            promise = promise.then(() => Timer.wait(this.settings.delay));\n         }\n\n         return promise;\n      }, Promise.resolve());\n   }\n\n   /**\n    * Reads the main element of the page\n    *\n    * @return {Promise}\n    */\n   readMain() {\n      let main = Dom.getMain();\n      let state = statusMap.get(this);\n\n      state.elements = [main];\n      state.currentIndex = 0;\n\n      if (!main) {\n         return Promise.reject(new WebReaderError('The main content of this page cannot be found'));\n      }\n\n      return this.speaker.speak(main.textContent);\n   }\n\n   /**\n    * Searches the main content of the page. If the element is found, it is focused\n    */\n   searchMain() {\n      let main = Dom.getMain();\n\n      if (!main) {\n         return Promise.reject(new WebReaderError('The main content of this page cannot be found'));\n      }\n\n      let oldTabIndex = main.getAttribute('tabindex');\n\n      main.setAttribute('tabindex', -1);\n      main.addEventListener('blur', function removeTabIndex() {\n         main.removeEventListener('blur', removeTabIndex);\n\n         // Restore tabindex's old value, if any\n         if (oldTabIndex) {\n            main.setAttribute('tabindex', oldTabIndex);\n         } else {\n            main.removeAttribute('tabindex');\n         }\n      });\n      main.focus();\n   }\n\n   /**\n    * Reads the title of a page, if present or not empty\n    *\n    * @return {Promise}\n    */\n   readPageTitle() {\n      let title = Dom.getTitle();\n\n      if (title) {\n         return this.speaker.speak(`The title of the page is ${title}`);\n      } else {\n         return this.speaker.speak('This page does not have a title');\n      }\n   }\n\n   /**\n    * Reads a summary of the content of the page\n    *\n    * @return {Promise}\n    */\n   readPageSummary() {\n      let headers = Dom.getHeaders();\n      let links = Dom.getLinks();\n\n      return this.speaker.speak(`The page contains ${headers.length} headers and ${links.length} links`);\n   }\n\n   /**\n    * Goes to the previous page as specified by the browser's history\n    */\n   goToPreviousPage() {\n      window.history.back();\n   }\n\n   /**\n    * Goes to the next page as specified by the browser's history\n    */\n   goToNextPage() {\n      window.history.forward();\n   }\n\n   /**\n    * Goes to the homepage\n    */\n   goToHomepage() {\n      window.location.assign('/');\n   }\n}","import EventEmitter from '../helpers/event-emitter';\nimport WebReaderError from '../webreader-error';\n\n/**\n * @typedef SpeechRecognitionHash\n * @type {Object}\n * @property {Object[]} [grammars=[]] The collection of <code>SpeechGrammar</code> objects which represent the grammars\n * that are active for this recognition\n * @property {string} [lang=''] The language of the recognition for the request.\n * If unspecified it defaults to the language of the html document root element\n * @property {boolean} [continuous=false] Controls whether the interaction is stopped when the user stops speaking or not\n * @property {boolean} [interimResults=false] Controls whether interim results are returned or not\n * @property {number} [maxAlternatives=1] The maximum number of <code>SpeechRecognitionAlternative</code>s per result\n * @property {string} [serviceURI=''] The location of the speech recognition service to use\n *\n * @see https://dvcs.w3.org/hg/speech-api/raw-file/tip/webspeechapi.html#speechreco-attributes\n */\n\n/**\n * Retrieves the object that allows to recognize the speech or\n * <code>null</code> if the feature is not supported\n *\n * @returns {SpeechRecognition|null}\n */\nfunction getRecognizer() {\n   return window.SpeechRecognition ||\n          window.webkitSpeechRecognition ||\n          null;\n}\n\n/**\n * Binds one or more events to a <code>SpeechRecognition</code> object\n *\n * @param {SpeechRecognition} recognizer A <code>SpeechRecognition</code> object\n * @param {Object} eventsHash An object of name-function pairs,\n * where name is the event to listen and function is the function to attach\n */\nfunction bindEvents(recognizer, eventsHash) {\n   for (let eventName in eventsHash) {\n      recognizer.addEventListener(eventName, eventsHash[eventName]);\n   }\n}\n\n/**\n * Unbinds one or more events to a <code>SpeechRecognition</code> object\n *\n * @param {SpeechRecognition} recognizer A <code>SpeechRecognition</code> object\n * @param {Object} eventsHash An object of name-function pairs,\n * where name is the event to listen and function is the function to attach\n */\nfunction unbindEvents(recognizer, eventsHash) {\n   for (let eventName in eventsHash) {\n      recognizer.removeEventListener(eventName, eventsHash[eventName]);\n   }\n}\n\n/**\n * The class exposing the reading features of a web page\n *\n * @class\n */\nexport default class Recognizer {\n   /**\n    * Creates a Recognizer instance\n    *\n    * @constructor\n    *\n    * @param {SpeechRecognitionHash} [options={}] The options to customize the settings of the recognizer\n    */\n   constructor(options={}) {\n      let Recognizer = getRecognizer();\n\n      if (!Recognizer) {\n         throw Error('API not supported');\n      }\n\n      /**\n       * The speech recognizer used\n       *\n       * @type {SpeechRecognition}\n       */\n      this.recognizer = new Recognizer();\n\n      for(let key in options) {\n         if (options.hasOwnProperty(key) && this.recognizer[key] !== undefined) {\n            this.recognizer[key] = options[key];\n         }\n      }\n   }\n\n   /**\n    * Detects if the recognition feature is supported\n    *\n    * @returns {boolean}\n    */\n   static isSupported() {\n      return !!getRecognizer();\n   }\n\n   /**\n    * Starts the recognition of the speech\n    *\n    * @returns {Promise}\n    */\n   recognize() {\n      return new Promise((resolve, reject) => {\n         let recognizer = this.recognizer;\n         let eventsHash = {\n            audiostart: () => {\n               EventEmitter.fireEvent(`${EventEmitter.namespace}.recognitionstart`, document);\n            },\n            result: event => {\n               for (let i = event.resultIndex; i < event.results.length; i++) {\n                  if (event.results[i].isFinal) {\n                     let bestGuess = event.results[i][0];\n\n                     console.debug('Recognition completed');\n                     console.debug(`Recognized \"${bestGuess.transcript}\" with a confidence of ${bestGuess.confidence}`);\n\n                     EventEmitter.fireEvent(`${EventEmitter.namespace}.recognitionresult`, document, {\n                        data: {\n                           result: bestGuess\n                        }\n                     });\n\n                     resolve(bestGuess.transcript);\n                  }\n               }\n            },\n            error: event => {\n               console.debug('Recognition error:', event.error);\n\n               EventEmitter.fireEvent(`${EventEmitter.namespace}.recognitionerror`, document, {\n                  error: event.error\n               });\n\n               reject(new WebReaderError('An error has occurred while recognizing your speech'));\n            },\n            noMatch: () => {\n               console.debug('Recognition ended because of nomatch');\n\n               EventEmitter.fireEvent(`${EventEmitter.namespace}.recognitionnomatch`, document);\n\n               reject(new WebReaderError('Sorry, I could not find a match'));\n            },\n            end: () => {\n               console.debug('Recognition ended');\n\n               EventEmitter.fireEvent(`${EventEmitter.namespace}.recognitionend`, document);\n\n               unbindEvents(recognizer, eventsHash);\n\n               // If the Promise isn't resolved or rejected at this point\n               // the demo is running on Chrome and Windows 8.1 (issue #428873).\n               reject(new WebReaderError('Sorry, I could not recognize your speech'));\n            }\n         };\n\n         bindEvents(this.recognizer, eventsHash);\n\n         console.debug('Recognition started');\n         this.recognizer.start();\n      });\n   }\n\n   /**\n    * Stops listening and recognizing the speech of the user\n    */\n   abort() {\n      this.recognizer.abort();\n   }\n}","import EventEmitter from '../helpers/event-emitter';\nimport WebReaderError from '../webreader-error';\n\n/**\n * This constant is needed because Chrome doesn't fire an error event\n * if the <code>cancel()</code> method is called.\n *\n * @type {Symbol}\n */\nconst isCancelledSymbol = Symbol('isCancelled');\n\n/**\n * @typedef SpeechSynthesisUtteranceHash\n * @type {Object}\n * @property {string} text The text to be synthesized and spoken\n * @property {string} [lang=''] The language of the speech synthesis for the utterance.\n * If unspecified it defaults to the language of the html document root element\n * @property {string} [voice=''] The voice to use\n * @property {number} [volume=1.0] The speaking volume\n * @property {number} [rate=1.0] The speaking rate\n * @property {number} [pitch=1.0] The speaking pitch\n *\n * @see {@link https://dvcs.w3.org/hg/speech-api/raw-file/tip/webspeechapi.html#utterance-attributes|SpeechSynthesisUtterance Attributes}\n */\n\n/**\n * Retrieves the object that allows to speech the text or\n * <code>null</code> if the feature is not supported\n *\n * @returns {speechSynthesis|null}\n */\nfunction getSpeaker() {\n   return speechSynthesis ||\n          null;\n}\n\n/**\n * Sets the settings for a <code>SpeechSynthesisUtterance</code> object\n *\n * @param {SpeechSynthesisUtterance} utterance The object whose settings will be set\n * @param {SpeechSynthesisUtteranceHash} settings\n * @param {string[]} voices The voices available\n */\nfunction setUtteranceSettings(utterance, settings, voices) {\n   for(let key in settings) {\n      if (!settings.hasOwnProperty(key) || utterance[key] === undefined) {\n         continue;\n      }\n\n      if (key !== 'voice') {\n         utterance[key] = settings[key];\n         continue;\n      }\n\n      let voice = voices\n         .filter(voice => voice.voiceURI === settings[key])\n         .pop();\n\n      if (voice) {\n         utterance[key] = voice;\n      } else {\n         console.debug('The voice selected is not available. Falling back to one available');\n         utterance[key] = voices[0];\n      }\n   }\n}\n\n/**\n * The class exposing the speaking features of a web page\n *\n * @class\n */\nexport default class Speaker {\n   /**\n    * Creates a Speaker instance\n    *\n    * @constructor\n    *\n    * @param {SpeechSynthesisUtteranceHash} [options={}] The options to customize the voice prompting the texts\n    */\n   constructor(options = {}) {\n      /**\n       *\n       * @type {speechSynthesis|null}\n       */\n      this.speaker = getSpeaker();\n      /**\n       *\n       * @type {SpeechSynthesisUtteranceHash}\n       */\n      this.settings = options;\n      /**\n       *\n       * @type {boolean}\n       */\n      this[isCancelledSymbol] = false;\n\n      if (!this.speaker) {\n         throw Error('API not supported');\n      }\n   }\n\n   /**\n    * Detects if the speech feature is supported\n    *\n    * @returns {boolean}\n    */\n   static isSupported() {\n      return !!getSpeaker();\n   }\n\n   /**\n    * Returns the list of voices available\n    *\n    * @return {Promise}\n    */\n   getVoices() {\n      return new Promise(resolve => {\n         let voices = this.speaker.getVoices();\n\n         if (voices.length > 1) {\n            return resolve(voices);\n         } else {\n            let onVoicesChanged = function() {\n               resolve(this.speaker.getVoices());\n\n               getSpeaker().removeEventListener('voiceschanged', onVoicesChanged);\n            }.bind(this);\n\n            getSpeaker().addEventListener('voiceschanged', onVoicesChanged);\n         }\n      });\n   }\n\n   /**\n    * Prompts a text\n    *\n    * @param {string} text The text to prompt\n    *\n    * @returns {Promise}\n    */\n   speak(text) {\n      return this\n         .getVoices()\n         .then(voices => {\n            return new Promise((resolve, reject) => {\n               let utterance = new window.SpeechSynthesisUtterance(text);\n               let eventData = Object.assign({text}, this.settings);\n\n               setUtteranceSettings(utterance, this.settings, voices);\n\n               utterance.addEventListener('start', () => {\n                  console.debug(`Synthesizing the text: ${text}`);\n\n                  EventEmitter.fireEvent(`${EventEmitter.namespace}.synthesisstart`, document, {\n                     data: eventData\n                  });\n               });\n\n               utterance.addEventListener('end', () => {\n                  console.debug('Synthesis completed');\n\n                  EventEmitter.fireEvent(`${EventEmitter.namespace}.synthesisend`, document, {\n                     data: eventData\n                  });\n\n                  if (this[isCancelledSymbol]) {\n                     this[isCancelledSymbol] = false;\n                     return reject({\n                        error: 'interrupted'\n                     });\n                  }\n\n                  resolve();\n               });\n\n               utterance.addEventListener('error', event => {\n                  console.debug('Synthesis error: ', event.error);\n\n                  EventEmitter.fireEvent(`${EventEmitter.namespace}.synthesiserror`, document, {\n                     data: eventData\n                  });\n\n                  reject(new WebReaderError('An error has occurred while speaking'));\n               });\n\n               this.speaker.speak(utterance);\n            })\n         });\n   }\n\n   /**\n    * Stops the prompt of the utterance\n    */\n   cancel() {\n      this.speaker.cancel();\n      this[isCancelledSymbol] = true;\n   }\n}","import WebReaderError from './webreader-error';\n\n/**\n * The class responsible of the routing of the commands\n *\n * @class\n */\nexport\n default class Router {\n   /**\n    * Performs an action based on the command recognized\n    *\n    * @param {WebReader} webReader An instance of WebReader\n    * @param {CommandsHash} recognizedCommand The command recognized\n    *\n    * @return {Promise|WebReaderError|undefined}\n    */\n   static route(webReader, recognizedCommand) {\n      /* jshint -W074 */\n      if (recognizedCommand.command === 'READ_ALL_HEADERS') {\n         return webReader.readHeaders();\n      } else if (recognizedCommand.command === 'READ_ALL_LINKS') {\n         return webReader.readLinks();\n      } else if (recognizedCommand.command === 'READ_LEVEL_HEADERS') {\n         return webReader.readHeaders({\n            level: recognizedCommand.level\n         });\n      } else if (recognizedCommand.command === 'READ_MAIN') {\n         return webReader.readMain();\n      } else if (recognizedCommand.command === 'SEARCH_MAIN') {\n         return webReader.searchMain();\n      } else if (recognizedCommand.command === 'READ_AGAIN') {\n         return webReader.readCurrentElement();\n      } else if (recognizedCommand.command === 'READ_PREVIOUS') {\n         return webReader.readPreviousElement();\n      } else if (recognizedCommand.command === 'READ_NEXT') {\n         return webReader.readNextElement();\n      } else if (recognizedCommand.command === 'READ_PAGE_TITLE') {\n         return webReader.readPageTitle();\n      } else if (recognizedCommand.command === 'READ_LINKS_IN_ELEMENT') {\n         return webReader.readLinks({\n            ancestor: recognizedCommand.element\n         });\n      } else if (recognizedCommand.command === 'GO_TO_PREVIOUS_PAGE') {\n         return webReader.goToPreviousPage();\n      } else if (recognizedCommand.command === 'GO_TO_NEXT_PAGE') {\n         return webReader.goToNextPage();\n      } else if (recognizedCommand.command === 'READ_PAGE_SUMMARY') {\n         return webReader.readPageSummary();\n      } else if (recognizedCommand.command === 'GO_TO_HOMEPAGE') {\n         return webReader.goToHomepage();\n      } else if (recognizedCommand.command === 'GO_TO_LINK') {\n         return webReader.goToLink();\n      } else {\n         throw new WebReaderError('The command is not supported');\n      }\n   }\n}","// @TODO Extends Error. At the moment, Babel doesn't support subclassing native types\n\n/**\n * The class representing the errors thrown by WebReader\n *\n * @class\n */\nexport\n default class WebReaderError {\n   /**\n    * Creates an instance of WebReaderError\n    *\n    * @constructor\n    *\n    * @param {string} message The message of the error\n    */\n   constructor(message) {\n      /**\n       * The name of error\n       *\n       * @type {string} WebReaderError\n       */\n      this.name = this.constructor.name;\n      /**\n       * The message describing the error\n       *\n       * @type {string}\n       */\n      this.message = message;\n   }\n}"],"sourceRoot":"/source/"}