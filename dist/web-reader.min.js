!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.WebReader=e()}}(function(){var e;return function t(e,n,r){function o(a,u){if(!n[a]){if(!e[a]){var s="function"==typeof require&&require;if(!u&&s)return s(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[a]={exports:{}};e[a][0].call(f.exports,function(t){var n=e[a][1][t];return o(n?n:t)},f,f.exports,t,e,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){t.exports={commands:{READ_ALL_HEADERS:{text:"read all headers",variations:["read headers","read all the headers"]},READ_ALL_LINKS:{text:"read all links",variations:["read links","read all the links"]},READ_LEVEL_HEADERS:{text:"read all h",variations:["read h","read all the h"],levels:["one","two","three","four","five","six"]},READ_MAIN:{text:"read main content",variations:["read the main","read the main content"]},SEARCH_MAIN:{text:"search main content",variations:["search the main","search the main content","find main content","find the main","find the main content"]},READ_AGAIN:{text:"read element again",variations:["read the current element again","read again"]},READ_PREVIOUS:{text:"read previous element",variations:["read previous"]},READ_NEXT:{text:"read next element",variations:["read next"]},READ_PAGE_TITLE:{text:"read page title",variations:["read title","read the title of the page","read document title"]},READ_LINKS_IN_ELEMENT:{text:"read links inside",variations:["read links contained","read links contained in","read all links inside","read all links contained","read all links contained in"]},GO_TO_PREVIOUS_PAGE:{text:"previous page",variations:["go to previous page"]},GO_TO_NEXT_PAGE:{text:"next page",variations:["go to next page"]},READ_PAGE_SUMMARY:{text:"read page summary",variations:["summarize page","summarize the page"]},GO_TO_HOMEPAGE:{text:"homepage",variations:["go to homepage"]},GO_TO_LINK:{text:"go to link",variations:["follow link","go","go there"]}},elements:{MAIN:{selector:"main",variations:["main"]},NAV:{selector:"nav",variations:["nav","navigation","menu"]},HEADER:{selector:"header",variations:["header"]},FOOTER:{selector:"footer",variations:["footer"]}}}},{}],2:[function(e,t,n){function r(e,t){function n(e,n){var u=[];return e===n?0:(e=e.split(""),e.unshift(null),n=n.split(""),n.unshift(null),e.forEach(function(s,c){u[c]||(u[c]=[]),n.forEach(function(f,l){0===c&&0===l?u[c][l]=0:0===c?u[c][l]=u[c][l-1]+r(f):0===l?u[c][l]=u[c-1][l]+o(s):(u[c][l]=Math.min(u[c-1][l]+o(s),u[c][l-1]+r(f),u[c-1][l-1]+(s===f?0:i(s,f))),t&&c>1&&l>1&&e[c-1]===f&&s===n[l-1]&&(u[c][l]=Math.min(u[c][l],u[c-2][l-2]+(s===f?0:a(s,e[c-1])))))})}),u[e.length-1][n.length-1])}t!==!1&&(t=!0),e||(e={});var r,o,i,a;switch(typeof e.insert){case"function":r=e.insert;break;case"number":r=function(t){return e.insert};break;default:r=function(e){return 1}}switch(typeof e.remove){case"function":o=e.remove;break;case"number":o=function(t){return e.remove};break;default:o=function(e){return 1}}switch(typeof e.substitute){case"function":i=e.substitute;break;case"number":i=function(t,n){return e.substitute};break;default:i=function(e,t){return 1}}switch(typeof e.transpose){case"function":a=e.transpose;break;case"number":a=function(t,n){return e.transpose};break;default:a=function(e,t){return 1}}return n}t.exports=r},{}],3:[function(t,n,r){!function(o,i){if("function"==typeof e&&e.amd)e("WebReader",["module","exports","./helpers/string-comparers/string-comparer"],i);else if("undefined"!=typeof r)i(n,r,t("./helpers/string-comparers/string-comparer"));else{var a={exports:{}};i(a,a.exports,o.stringComparer),o.WebReader=a.exports}}(this,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=l.commands.READ_LEVEL_HEADERS.levels,r={},o=0;o<n.length;o++){var i=new RegExp("(^|\\b)("+(o+1)+"|h"+(o+1)+"|"+n[o]+")(\\b|$)","i");if(i.test(t)){r.level=o+1;break}}if(!r.level){var a=e.findCloserMatch(n,t).index;r.level=a+1}return r}function a(e){var t=l.elements,n=null;for(var r in t){var o=t[r].variations.join("|"),i=new RegExp("(^|\\b)("+o+")(\\b|$)","i");if(i.test(e)){n=document.querySelector(t[r].selector);break}}return n}function u(e,t){var n=a(t);if(n)return{element:n};var r=[],o=l.elements;for(var i in o){var u=o[i].variations,s=e.findCloserMatch(u,t).index;r.push(u[s])}var c=e.findCloserMatch(r,t);return{element:document.querySelector(r[c.index])}}function s(e,t,n){var r={};return"READ_LEVEL_HEADERS"===t?r=i(e,n):"READ_LINKS_IN_ELEMENT"===t&&(r=u(e,n)),r}Object.defineProperty(t,"__esModule",{value:!0});var c=r(n),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=null,d=function(){function e(t){if(o(this,e),"function"!=typeof t||!(t.prototype instanceof c["default"]))throw new TypeError(arguments[0]+" is not an instance of StringComparer");Object.defineProperty(this,"StringComparer",{enumerable:!1,configurable:!1,get:function(){return t}})}return f(e,[{key:"recognizeCommand",value:function(e,t){var n=Number.POSITIVE_INFINITY,r=t.commands,o=void 0;l=t,e=e.toLocaleLowerCase();for(var i in r){var a=this.StringComparer.findCloserMatch([r[i].text].concat(r[i].variations),e);if(a.distance<n){if(o=Object.assign({command:i},s(this.StringComparer,i,e)),0===a.distance)break;n=a.distance}}return o}}]),e}();t["default"]=d,e.exports=t["default"]})},{"./helpers/string-comparers/string-comparer":11}],4:[function(t,n,r){!function(t,n){if("function"==typeof e&&e.amd)e("WebReader",["exports"],n);else if("undefined"!=typeof r)n(r);else{var o={exports:{}};n(o.exports),t.WebReader=o.exports}}(this,function(e){"use strict";function t(){return document.title}Object.defineProperty(e,"__esModule",{value:!0}),e.getTitle=t})},{}],5:[function(t,n,r){!function(o,i){if("function"==typeof e&&e.amd)e("WebReader",["module","exports","./document","./headers","./links","./main"],i);else if("undefined"!=typeof r)i(n,r,t("./document"),t("./headers"),t("./links"),t("./main"));else{var a={exports:{}};i(a,a.exports,o.document,o.headers,o.links,o.main),o.WebReader=a.exports}}(this,function(e,t,n,r,o,i){"use strict";function a(e){e instanceof HTMLElement&&(e.innerHTML="<mark>"+e.innerHTML+"</mark>")}function u(e){e instanceof HTMLElement&&(e.innerHTML=e.innerHTML.replace(/^<mark>/,"").replace(/<\/mark>$/,""))}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={getHeaders:r.getHeaders,getLinks:o.getLinks,getMain:i.getMain,getTitle:n.getTitle,highlightElement:a,unhighlightElement:u},e.exports=t["default"]})},{"./document":4,"./headers":6,"./links":7,"./main":8}],6:[function(t,n,r){!function(t,n){if("function"==typeof e&&e.amd)e("WebReader",["exports"],n);else if("undefined"!=typeof r)n(r);else{var o={exports:{}};n(o.exports),t.WebReader=o.exports}}(this,function(e){"use strict";function t(e){return e&&e.nodeName&&0===e.nodeName.toLowerCase().indexOf("h")?parseInt(e.nodeName.charAt(1),10):0}function n(e){var n=[];return function r(e,n,o){if(n.index===e.length)return o;var i=t(e[n.index]),a={element:e[n.index],subheadings:[]};return 0===o.length||i===t(o[o.length-1].element)?(o.push(a),n.index++,r(e,n,o)):(i>t(o[o.length-1].element)&&(o[o.length-1].subheadings=r(e,n,[])),i=t(e[n.index]),i===t(o[o.length-1].element)?r(e,n,o):o)}(e,{index:0},n),n}function r(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=void 0;e=Object.assign({level:-1,text:""},e),t=-1===e.level?"h1, h2, h3, h4, h5, h6":"h"+e.level;var n=new RegExp("(^|\\b)"+e.text+"(\\b|$)","i"),r=Array.from(document.querySelectorAll(t)).filter(function(e){return e.textContent.search(n)>=0});return r}Object.defineProperty(e,"__esModule",{value:!0}),e.createHeadingsStructure=n,e.getHeaders=r})},{}],7:[function(t,n,r){!function(t,n){if("function"==typeof e&&e.amd)e("WebReader",["exports"],n);else if("undefined"!=typeof r)n(r);else{var o={exports:{}};n(o.exports),t.WebReader=o.exports}}(this,function(e){"use strict";function t(e){return"none"!==window.getComputedStyle(e).display&&"true"!==e.getAttribute("aria-hidden")}function n(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];e=Object.assign({ancestor:document},e);var n=e.ancestor.querySelectorAll("a");return Array.from(n).filter(function(e){return t(e)})}Object.defineProperty(e,"__esModule",{value:!0}),e.getLinks=n})},{}],8:[function(t,n,r){!function(t,n){if("function"==typeof e&&e.amd)e("WebReader",["exports"],n);else if("undefined"!=typeof r)n(r);else{var o={exports:{}};n(o.exports),t.WebReader=o.exports}}(this,function(e){"use strict";function t(){var e=document.querySelector("main")||document.querySelector('[role="main"]');if(!e){var t=document.querySelectorAll("#main-content, .main-content, #main, .main");1===t.length&&(e=t[0])}return e}Object.defineProperty(e,"__esModule",{value:!0}),e.getMain=t})},{}],9:[function(t,n,r){!function(t,o){if("function"==typeof e&&e.amd)e("WebReader",["module","exports"],o);else if("undefined"!=typeof r)o(n,r);else{var i={exports:{}};o(i,i.exports),t.WebReader=i.exports}}(this,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e)}return r(e,null,[{key:"namespaceEvent",value:function(t){return e.namespace+"."+t}},{key:"fireEvent",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=document.createEvent("Event");r.initEvent(e,!0,!0),Object.getOwnPropertyNames(n).forEach(function(e){return r[e]=n[e]}),t.dispatchEvent(r)}},{key:"namespace",get:function(){return"webreader"}}]),e}();t["default"]=o,e.exports=t["default"]})},{}],10:[function(t,n,r){!function(o,i){if("function"==typeof e&&e.amd)e("WebReader",["module","exports","damerau-levenshtein","./string-comparer"],i);else if("undefined"!=typeof r)i(n,r,t("damerau-levenshtein"),t("./string-comparer"));else{var a={exports:{}};i(a,a.exports,o.damerauLevenshtein,o.stringComparer),o.WebReader=a.exports}}(this,function(e,t,n,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(n),c=o(r),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function(e){function t(){return i(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return u(t,e),f(t,null,[{key:"findCloserMatch",value:function(e,t){Array.isArray(e)||(e=[e]);for(var n=(0,s["default"])(),r=Number.POSITIVE_INFINITY,o=-1,i=0;i<e.length;i++){var a=n(e[i],t);if((0===a||r>a)&&(r=a,o=i,0===a))break}return{index:o,distance:r}}}]),t}(c["default"]);t["default"]=l,e.exports=t["default"]})},{"./string-comparer":11,"damerau-levenshtein":2}],11:[function(t,n,r){!function(t,o){if("function"==typeof e&&e.amd)e("WebReader",["module","exports"],o);else if("undefined"!=typeof r)o(n,r);else{var i={exports:{}};o(i,i.exports),t.WebReader=i.exports}}(this,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e)}return r(e,null,[{key:"findCloserMatch",value:function(e,t){throw new Error("The "+arguments.callee.name+" function must be overridden")}}]),e}();t["default"]=o,e.exports=t["default"]})},{}],12:[function(t,n,r){!function(t,o){if("function"==typeof e&&e.amd)e("WebReader",["module","exports"],o);else if("undefined"!=typeof r)o(n,r);else{var i={exports:{}};o(i,i.exports),t.WebReader=i.exports}}(this,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e)}return r(e,null,[{key:"wait",value:function(e){return new Promise(function(t){return window.setTimeout(t,e)})}}]),e}();t["default"]=o,e.exports=t["default"]})},{}],13:[function(t,n,r){!function(o,i){if("function"==typeof e&&e.amd)e("WebReader",["module","exports","./commands","./dom/dom","./reader/recognizer","./router","./reader/speaker","./helpers/event-emitter","./helpers/string-comparers/damerau-levenshtein-comparer","./helpers/timer","./webreader-error","../lang/en-GB.json"],i);else if("undefined"!=typeof r)i(n,r,t("./commands"),t("./dom/dom"),t("./reader/recognizer"),t("./router"),t("./reader/speaker"),t("./helpers/event-emitter"),t("./helpers/string-comparers/damerau-levenshtein-comparer"),t("./helpers/timer"),t("./webreader-error"),t("../lang/en-GB.json"));else{var a={exports:{}};i(a,a.exports,o.commands,o.dom,o.recognizer,o.router,o.speaker,o.eventEmitter,o.damerauLevenshteinComparer,o.timer,o.webreaderError,o.enGB),o.WebReader=a.exports}}(this,function(e,t,n,r,o,i,a,u,s,c,f,l){"use strict";function d(e){return e&&e.__esModule?e:{"default":e}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){return window.fetch(e+"/"+t+".json").then(function(e){return e.json()}).then(function(e){return I.set(t,e),e})}function h(e,t){if(t.ctrlKey===!0&&(t.code&&"Space"===t.code||32===t.which))if(e.isInteracting()){var n=M.get(e),r=n.elements[n.currentIndex];r&&g["default"].unhighlightElement(r),e.stopCommand()}else e.receiveCommand()}Object.defineProperty(t,"__esModule",{value:!0});var v=d(n),g=d(r),y=d(o),b=d(i),E=d(a),w=d(u),x=d(s),k=d(c),_=d(f),P=d(l),R=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),A="en-GB",O={delay:300,translationsPath:"",recognizer:{lang:A},speaker:{lang:A,voice:"Google UK English Female"}},T={isInteracting:!1,elements:[],currentIndex:-1},L=new WeakMap,M=new WeakMap,I=new Map([[A,P["default"]]]),j=function(){function e(){var t=this,n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];p(this,e),this.settings=Object.assign({},O,n),this.recognizer=new y["default"](this.settings.recognizer),this.speaker=new E["default"](this.settings.speaker),M.set(this,Object.assign({},T)),L.set(this,new Map);var r=this.settings.recognizer.lang;r&&!I.has(r)&&m(this.settings.translationsPath,r).then(function(){var e='Language "'+r+'" successfully loaded';return w["default"].fireEvent(w["default"].namespace+".languagedownload",document,{data:{lang:r}}),t.speaker.speak(e)},function(e){return w["default"].fireEvent(w["default"].namespace+".languageerror",document,{data:{lang:r}}),t.speaker.speak('An error occurred: the language "'+r+'" was not loaded')})}return R(e,[{key:"isInteracting",value:function(){return M.get(this).isInteracting}},{key:"enableShortcuts",value:function(){var e=L.get(this);return e.set("keydown",h.bind(this,this)),document.documentElement.addEventListener("keydown",e.get("keydown")),this}},{key:"disableShortcuts",value:function(){var e=L.get(this);return document.documentElement.removeEventListener("keydown",e.get("keydown")),e["delete"]("keydown"),this}},{key:"receiveCommand",value:function(){var e=this;return M.get(this).isInteracting=!0,w["default"].fireEvent(w["default"].namespace+".interactionstart",document),this.speaker.speak("Ready").then(function(){return e.recognizer.recognize()}).then(function(t){var n=new v["default"](x["default"]),r=I.get(e.settings.recognizer.lang);return n.recognizeCommand(t,r)}).then(function(t){return b["default"].route(e,t)})["catch"](function(t){return t instanceof _["default"]?e.speaker.speak(t.message):"aborted"!==t.error&&"interrupted"!==t.error?(M.set(e,Object.assign({},T)),e.speaker.speak("Sorry, I could not recognize the command")):void 0}).then(function(){},function(){}).then(function(){M.get(e).isInteracting=!1,w["default"].fireEvent(w["default"].namespace+".interactionend",document)})}},{key:"stopCommand",value:function(){this.recognizer.abort(),this.speaker.cancel(),M.get(this).isInteracting=!1}},{key:"readHeaders",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=g["default"].getHeaders(t),r=t&&t.level?t.level:-1;return M.get(this).elements=n,n.reduce(function(t,n,o){return t=t.then(function(){return M.get(e).currentIndex=o,g["default"].highlightElement(n),e.speaker.speak(n.textContent+(-1!==r?"":" "+n.nodeName)).then(function(){return g["default"].unhighlightElement(n)})["catch"](function(e){return g["default"].unhighlightElement(n),Promise.reject(e)})}),e.settings.delay>0&&(t=t.then(function(){return k["default"].wait(e.settings.delay)})),t},Promise.resolve())}},{key:"readCurrentElement",value:function(){var e=M.get(this),t=e.elements[e.currentIndex];return t?(g["default"].highlightElement(t),this.speaker.speak(t.textContent).then(function(){return g["default"].unhighlightElement(t)})["catch"](function(e){return g["default"].unhighlightElement(t),Promise.reject(e)})):Promise.reject(new _["default"]("There is not a current element to read"))}},{key:"readPreviousElement",value:function(){var e=M.get(this);return 0===e.currentIndex?Promise.reject(new _["default"]("The current element is the first")):(e.currentIndex--,this.readCurrentElement())}},{key:"readNextElement",value:function(){var e=M.get(this);return e.currentIndex===e.elements.length-1?Promise.reject(new _["default"]("The current element is the last")):(e.currentIndex++,this.readCurrentElement())}},{key:"goToLink",value:function(){var e=M.get(this),t=e.elements[e.currentIndex];if(!t||"A"!==t.nodeName)throw new _["default"]("There is not a current link to follow");window.location.assign(t.href)}},{key:"readLinks",value:function(e){var t=this,n=g["default"].getLinks(e);return M.get(this).elements=n,n.reduce(function(e,n,r){return e=e.then(function(){return M.get(t).currentIndex=r,t.readCurrentElement()}),t.settings.delay>0&&(e=e.then(function(){return k["default"].wait(t.settings.delay)})),e},Promise.resolve())}},{key:"readMain",value:function(){var e=g["default"].getMain(),t=M.get(this);return e?(t.elements=[e],t.currentIndex=0,this.speaker.speak(e.textContent)):Promise.reject(new _["default"]("The main content of this page cannot be found"))}},{key:"searchMain",value:function(){var e=g["default"].getMain();if(!e)throw new _["default"]("The main content of this page has not been found");var t=e.getAttribute("tabindex");e.setAttribute("tabindex",-1),e.addEventListener("blur",function n(){e.removeEventListener("blur",n),t?e.setAttribute("tabindex",t):e.removeAttribute("tabindex")}),e.focus()}},{key:"readPageTitle",value:function(){var e=g["default"].getTitle();return e?this.speaker.speak("The title of the page is "+e):this.speaker.speak("This page does not have a title")}},{key:"readPageSummary",value:function(){var e=g["default"].getHeaders(),t=g["default"].getLinks();return this.speaker.speak("The page contains "+e.length+" headers and "+t.length+" links")}},{key:"goToPreviousPage",value:function(){return new Promise(function(e,t){function n(){window.removeEventListener("popstate",n),e()}window.addEventListener("popstate",n),window.history.back(),setTimeout(function(){t(new _["default"]("This is already the first page")),window.removeEventListener("popstate",n)},10)})}},{key:"goToNextPage",value:function(){return new Promise(function(e,t){function n(){window.removeEventListener("popstate",n),e()}window.addEventListener("popstate",n),window.history.forward(),setTimeout(function(){t(new _["default"]("This is already the last page")),window.removeEventListener("popstate",n)},10)})}},{key:"goToHomepage",value:function(){window.location.assign("/")}}]),e}();t["default"]=j,e.exports=t["default"]})},{"../lang/en-GB.json":1,"./commands":3,"./dom/dom":5,"./helpers/event-emitter":9,"./helpers/string-comparers/damerau-levenshtein-comparer":10,"./helpers/timer":12,"./reader/recognizer":14,"./reader/speaker":15,"./router":16,"./webreader-error":17}],14:[function(t,n,r){!function(o,i){if("function"==typeof e&&e.amd)e("WebReader",["module","exports","../helpers/event-emitter","../webreader-error"],i);else if("undefined"!=typeof r)i(n,r,t("../helpers/event-emitter"),t("../webreader-error"));else{var a={exports:{}};i(a,a.exports,o.eventEmitter,o.webreaderError),o.WebReader=a.exports}}(this,function(e,t,n,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(){return window.SpeechRecognition||window.webkitSpeechRecognition||null}function u(e,t){for(var n in t)e.addEventListener(n,t[n])}function s(e,t){for(var n in t)e.removeEventListener(n,t[n])}Object.defineProperty(t,"__esModule",{value:!0});var c=o(n),f=o(r),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];i(this,e);var n=a();if(!n)throw Error("API not supported");this.recognizer=new n;for(var r in t)t.hasOwnProperty(r)&&void 0!==this.recognizer[r]&&(this.recognizer[r]=t[r])}return l(e,[{key:"recognize",value:function(){var e=this;return new Promise(function(t,n){var r=e.recognizer,o={audiostart:function(){c["default"].fireEvent(c["default"].namespace+".recognitionstart",document)},result:function(e){for(var n=e.resultIndex;n<e.results.length;n++)if(e.results[n].isFinal){var r=e.results[n][0];c["default"].fireEvent(c["default"].namespace+".recognitionresult",document,{data:{result:r}}),t(r.transcript)}},error:function(e){c["default"].fireEvent(c["default"].namespace+".recognitionerror",document,{error:e.error}),n(new f["default"]("An error has occurred while recognizing your speech"))},noMatch:function(){c["default"].fireEvent(c["default"].namespace+".recognitionnomatch",document),n(new f["default"]("Sorry, I could not find a match"))},end:function(){c["default"].fireEvent(c["default"].namespace+".recognitionend",document),s(r,o),n(new f["default"]("Sorry, I could not recognize your speech"))}};u(e.recognizer,o),e.recognizer.start()})}},{key:"abort",value:function(){this.recognizer.abort()}}],[{key:"isSupported",value:function(){return!!a()}}]),e}();t["default"]=d,e.exports=t["default"]})},{"../helpers/event-emitter":9,"../webreader-error":17}],15:[function(t,n,r){!function(o,i){if("function"==typeof e&&e.amd)e("WebReader",["module","exports","../helpers/event-emitter","../webreader-error"],i);else if("undefined"!=typeof r)i(n,r,t("../helpers/event-emitter"),t("../webreader-error"));else{var a={exports:{}};i(a,a.exports,o.eventEmitter,o.webreaderError),o.WebReader=a.exports}}(this,function(e,t,n,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(){return window.speechSynthesis||null}function u(e,t){return e.filter(function(e){return e.voiceURI===t}).pop()}function s(e,t,n){for(var r in t)if(t.hasOwnProperty(r)&&void 0!==e[r])if("voice"===r){var o=u(n,t[r]);o?e[r]=o:e[r]=n[0]}else e[r]=t[r]}Object.defineProperty(t,"__esModule",{value:!0});var c=o(n),f=o(r),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=new WeakMap,p=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];i(this,e);var n=a();if(this.settings=t,!n)throw Error("API not supported");d.set(this,{speaker:n,isCancelled:!1})}return l(e,[{key:"isSpeaking",value:function(){return d.get(this).speaker.speaking}},{key:"getVoices",value:function(){var e=this;return new Promise(function(t){var n=d.get(e).speaker,r=n.getVoices();return r.length>1?t(r):void n.addEventListener("voiceschanged",function o(){n.removeEventListener("voiceschanged",o),t(n.getVoices())})})}},{key:"speak",value:function(e){var t=this;return this.getVoices().then(function(n){return new Promise(function(r,o){var i=d.get(t).speaker,a=new window.SpeechSynthesisUtterance(e),u=Object.assign({text:e},t.settings);s(a,t.settings,n),a.addEventListener("start",function(){c["default"].fireEvent(c["default"].namespace+".synthesisstart",document,{data:u})}),a.addEventListener("end",function(){var e=d.get(t);return c["default"].fireEvent(c["default"].namespace+".synthesisend",document,{data:u}),e.isCancelled?(e.isCancelled=!1,o({error:"interrupted"})):void r()}),a.addEventListener("error",function(e){c["default"].fireEvent(c["default"].namespace+".synthesiserror",document,{data:u}),o(new f["default"]("An error has occurred while speaking"))}),i.speak(a)})})}},{key:"cancel",value:function(){var e=d.get(this);this.isSpeaking()&&(e.isCancelled=!0),e.speaker.cancel()}}],[{key:"isSupported",value:function(){return!!a()}}]),e}();t["default"]=p,e.exports=t["default"]})},{"../helpers/event-emitter":9,"../webreader-error":17}],16:[function(t,n,r){!function(o,i){if("function"==typeof e&&e.amd)e("WebReader",["module","exports","./webreader-error"],i);else if("undefined"!=typeof r)i(n,r,t("./webreader-error"));else{var a={exports:{}};i(a,a.exports,o.webreaderError),o.WebReader=a.exports}}(this,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(){function e(){o(this,e)}return a(e,null,[{key:"route",value:function(e,t){return"READ_ALL_HEADERS"===t.command?e.readHeaders():"READ_ALL_LINKS"===t.command?e.readLinks():"READ_LEVEL_HEADERS"===t.command?e.readHeaders({level:t.level}):"READ_MAIN"===t.command?e.readMain():"SEARCH_MAIN"===t.command?new Promise(function(t,n){try{t(e.searchMain())}catch(r){n(r)}}):"READ_AGAIN"===t.command?e.readCurrentElement():"READ_PREVIOUS"===t.command?e.readPreviousElement():"READ_NEXT"===t.command?e.readNextElement():"READ_PAGE_TITLE"===t.command?e.readPageTitle():"READ_LINKS_IN_ELEMENT"===t.command?e.readLinks({ancestor:t.element}):"GO_TO_PREVIOUS_PAGE"===t.command?e.goToPreviousPage():"GO_TO_NEXT_PAGE"===t.command?e.goToNextPage():"READ_PAGE_SUMMARY"===t.command?e.readPageSummary():"GO_TO_HOMEPAGE"===t.command?Promise.resolve(e.goToHomepage()):"GO_TO_LINK"===t.command?new Promise(function(t,n){try{t(e.goToLink())}catch(r){n(r)}}):Promise.reject(new i["default"]("The command is not supported"))}}]),e}();t["default"]=u,e.exports=t["default"]})},{"./webreader-error":17}],17:[function(t,n,r){!function(t,o){if("function"==typeof e&&e.amd)e("WebReader",["module","exports"],o);else if("undefined"!=typeof r)o(n,r);else{var i={exports:{}};o(i,i.exports),t.WebReader=i.exports}}(this,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function o(e){n(this,o),this.name=this.constructor.name,this.message=e};t["default"]=r,e.exports=t["default"]})},{}]},{},[13])(13)});
//# sourceMappingURL=web-reader.min.js.map
