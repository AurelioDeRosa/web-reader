!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.WebReader=e()}}(function(){var e;return function t(e,n,r){function i(o,u){if(!n[o]){if(!e[o]){var s="function"==typeof require&&require;if(!u&&s)return s(o,!0);if(a)return a(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[o]={exports:{}};e[o][0].call(f.exports,function(t){var n=e[o][1][t];return i(n?n:t)},f,f.exports,t,e,n,r)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){t.exports={commands:{READ_ALL_HEADERS:{text:"read all headers",variations:["read headers","read all the headers"]},READ_ALL_LINKS:{text:"read all links",variations:["read links","read all the links"]},READ_LEVEL_HEADERS:{text:"read all h",variations:["read h","read all the h"],levels:["one","two","three","four","five","six"]},READ_MAIN:{text:"read main content",variations:["read the main","read the main content"]},SEARCH_MAIN:{text:"search main content",variations:["search the main","search the main content","find main content","find the main","find the main content"]},READ_AGAIN:{text:"read element again",variations:["read the current element again","read again"]},READ_PREVIOUS:{text:"read previous element",variations:["read previous"]},READ_NEXT:{text:"read next element",variations:["read next"]},READ_PAGE_TITLE:{text:"read page title",variations:["read title","read the title of the page","read document title"]},READ_LINKS_IN_ELEMENT:{text:"read links inside",variations:["read links contained","read links contained in","read all links inside","read all links contained","read all links contained in"]},GO_TO_PREVIOUS_PAGE:{text:"previous page",variations:["go to previous page"]},GO_TO_NEXT_PAGE:{text:"next page",variations:["go to next page"]},READ_PAGE_SUMMARY:{text:"read page summary",variations:["summarize page","summarize the page"]},GO_TO_HOMEPAGE:{text:"homepage",variations:["go to homepage"]},GO_TO_LINK:{text:"go to link",variations:["follow link","go","go there"]}},elements:{MAIN:{selector:"main",variations:["main"]},NAV:{selector:"nav",variations:["nav","navigation","menu"]},HEADER:{selector:"header",variations:["header"]},FOOTER:{selector:"footer",variations:["footer"]}}}},{}],2:[function(e,t,n){function r(e,t){function n(e,n){var u=[];return e===n?0:(e=e.split(""),e.unshift(null),n=n.split(""),n.unshift(null),e.forEach(function(s,c){u[c]||(u[c]=[]),n.forEach(function(f,l){0===c&&0===l?u[c][l]=0:0===c?u[c][l]=u[c][l-1]+r(f):0===l?u[c][l]=u[c-1][l]+i(s):(u[c][l]=Math.min(u[c-1][l]+i(s),u[c][l-1]+r(f),u[c-1][l-1]+(s===f?0:a(s,f))),t&&c>1&&l>1&&e[c-1]===f&&s===n[l-1]&&(u[c][l]=Math.min(u[c][l],u[c-2][l-2]+(s===f?0:o(s,e[c-1])))))})}),u[e.length-1][n.length-1])}t!==!1&&(t=!0),e||(e={});var r,i,a,o;switch(typeof e.insert){case"function":r=e.insert;break;case"number":r=function(t){return e.insert};break;default:r=function(e){return 1}}switch(typeof e.remove){case"function":i=e.remove;break;case"number":i=function(t){return e.remove};break;default:i=function(e){return 1}}switch(typeof e.substitute){case"function":a=e.substitute;break;case"number":a=function(t,n){return e.substitute};break;default:a=function(e,t){return 1}}switch(typeof e.transpose){case"function":o=e.transpose;break;case"number":o=function(t,n){return e.transpose};break;default:o=function(e,t){return 1}}return n}t.exports=r},{}],3:[function(t,n,r){!function(n,i){if("function"==typeof e&&e.amd)e("WebReader",["exports","damerau-levenshtein"],i);else if("undefined"!=typeof r)i(r,t("damerau-levenshtein"));else{var a={exports:{}};i(a.exports,n.damerauLevenshtein),n.WebReader=a.exports}}(this,function(e,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){Array.isArray(e)||(e=[e]);var n=(0,c["default"])(),r=Number.POSITIVE_INFINITY,i=void 0;for(i=0;i<e.length;i++){var a=n(e[i],t);if(0===a){r=a;break}r>a&&(r=a)}return{index:i===e.length?-1:i,distance:r}}function i(e){for(var t=f.commands.READ_LEVEL_HEADERS.levels,n={},i=0;i<t.length;i++){var a=new RegExp("(^|\\b)("+(i+1)+"|h"+(i+1)+"|"+t[i]+")(\\b|$)","i");if(a.test(e)){n.level=i+1;break}}if(!n.level){var o=r(t,e).index;n.level=-1===o?-1:o+1}return n}function a(e){var t=f.elements,n=null;for(var r in t){var i=t[r].variations.join("|"),a=new RegExp("(^|\\b)("+i+")(\\b|$)","i");if(a.test(e)){n=document.querySelector(t[r].selector);break}}return n}function o(e){var t=a(e);if(t)return{element:t};var n=[],i=f.elements;for(var o in i){var u=i[o].variations,s=r(u,e);-1!==s&&n.push(u[s])}return r(n,e)}function u(e,t){var n={};return"READ_LEVEL_HEADERS"===e?n=i(t):"READ_LINKS_IN_ELEMENT"===e&&(n=o(t)),n}function s(e,t){var n=Number.POSITIVE_INFINITY,i=t.commands,a=void 0;f=t,e=e.toLocaleLowerCase();for(var o in i){var s=r([i[o].text].concat(i[o].variations),e);if(s.distance<n){if(a=Object.assign({command:o},u(o,e)),0===s.distance)break;n=s.distance}}return a}Object.defineProperty(e,"__esModule",{value:!0}),e.recognizeCommand=s;var c=n(t),f=null})},{"damerau-levenshtein":2}],4:[function(t,n,r){!function(t,n){if("function"==typeof e&&e.amd)e("WebReader",["exports"],n);else if("undefined"!=typeof r)n(r);else{var i={exports:{}};n(i.exports),t.WebReader=i.exports}}(this,function(e){"use strict";function t(){return document.title}Object.defineProperty(e,"__esModule",{value:!0}),e.getTitle=t})},{}],5:[function(t,n,r){!function(i,a){if("function"==typeof e&&e.amd)e("WebReader",["module","exports","./document","./headers","./links","./main"],a);else if("undefined"!=typeof r)a(n,r,t("./document"),t("./headers"),t("./links"),t("./main"));else{var o={exports:{}};a(o,o.exports,i.document,i.headers,i.links,i.main),i.WebReader=o.exports}}(this,function(e,t,n,r,i,a){"use strict";function o(e){!e instanceof HTMLElement||(e.innerHTML="<mark>"+e.innerHTML+"</mark>")}function u(e){!e instanceof HTMLElement||(e.innerHTML=e.innerHTML.replace(/^<mark>/,"").replace(/<\/mark>$/,""))}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={getHeaders:r.getHeaders,getLinks:i.getLinks,getMain:a.getMain,getTitle:n.getTitle,highlightElement:o,unhighlightElement:u},e.exports=t["default"]})},{"./document":4,"./headers":6,"./links":7,"./main":8}],6:[function(t,n,r){!function(t,n){if("function"==typeof e&&e.amd)e("WebReader",["exports"],n);else if("undefined"!=typeof r)n(r);else{var i={exports:{}};n(i.exports),t.WebReader=i.exports}}(this,function(e){"use strict";function t(e){return e&&e.nodeName&&0===e.nodeName.toLowerCase().indexOf("h")?parseInt(e.nodeName.charAt(1),10):0}function n(e){var n=[];!function r(e,n,i){if(0===e.length||n.index===e.length)return i;var a=t(e[n.index]),o={element:e[n.index],subheadings:[]};return 0===i.length||a===t(i[i.length-1].element)?(i.push(o),n.index++,r(e,n,i)):(a>t(i[i.length-1].element)&&(i[i.length-1].subheadings=r(e,n,[])),a=t(e[n.index]),a===t(i[i.length-1].element)?r(e,n,i):i)}(e,{index:0},n)}function r(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=void 0;e=Object.assign({level:-1,text:""},e),t=-1===e.level?"h1, h2, h3, h4, h5, h6":"h"+e.level;var n=new RegExp("(^|\\b)"+e.text+"(\\b|$)","i"),r=Array.from(document.querySelectorAll(t)).filter(function(e){return e.textContent.search(n)>=0});return r}Object.defineProperty(e,"__esModule",{value:!0}),e.createHeadingsStructure=n,e.getHeaders=r})},{}],7:[function(t,n,r){!function(t,n){if("function"==typeof e&&e.amd)e("WebReader",["exports"],n);else if("undefined"!=typeof r)n(r);else{var i={exports:{}};n(i.exports),t.WebReader=i.exports}}(this,function(e){"use strict";function t(e){return"none"!==window.getComputedStyle(e).display&&"true"!==e.getAttribute("aria-hidden")}function n(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];e=Object.assign({ancestor:document},e);var n=e.ancestor.querySelectorAll("a");return Array.from(n).filter(function(e){return t(e)})}Object.defineProperty(e,"__esModule",{value:!0}),e.getLinks=n})},{}],8:[function(t,n,r){!function(t,n){if("function"==typeof e&&e.amd)e("WebReader",["exports"],n);else if("undefined"!=typeof r)n(r);else{var i={exports:{}};n(i.exports),t.WebReader=i.exports}}(this,function(e){"use strict";function t(){var e=document.querySelector("main")||document.querySelector('[role="main"]');if(!e){var t=document.querySelectorAll("#main-content, .main-content, #main, .main");1===t.length&&(e=t[0])}return e}Object.defineProperty(e,"__esModule",{value:!0}),e.getMain=t})},{}],9:[function(t,n,r){!function(t,i){if("function"==typeof e&&e.amd)e("WebReader",["module","exports"],i);else if("undefined"!=typeof r)i(n,r);else{var a={exports:{}};i(a,a.exports),t.WebReader=a.exports}}(this,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){n(this,e)}return r(e,null,[{key:"namespaceEvent",value:function(t){return e.namespace+"."+t}},{key:"fireEvent",value:function(e,t,n){var r=document.createEvent("Event");r.initEvent(e,!0,!0);for(var i in n)if(n.hasOwnProperty(i))try{r[i]=n[i]}catch(a){}t.dispatchEvent(r)}},{key:"namespace",get:function(){return"webreader"}}]),e}();t["default"]=i,e.exports=t["default"]})},{}],10:[function(t,n,r){!function(t,i){if("function"==typeof e&&e.amd)e("WebReader",["module","exports"],i);else if("undefined"!=typeof r)i(n,r);else{var a={exports:{}};i(a,a.exports),t.WebReader=a.exports}}(this,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){n(this,e)}return r(e,null,[{key:"wait",value:function(e){return new Promise(function(t){return window.setTimeout(t,e)})}}]),e}();t["default"]=i,e.exports=t["default"]})},{}],11:[function(t,n,r){!function(i,a){if("function"==typeof e&&e.amd)e("WebReader",["module","exports","./commands","./dom/dom","./reader/recognizer","./router","./reader/speaker","./helpers/event-emitter","./helpers/timer","./webreader-error","../lang/en-GB.json"],a);else if("undefined"!=typeof r)a(n,r,t("./commands"),t("./dom/dom"),t("./reader/recognizer"),t("./router"),t("./reader/speaker"),t("./helpers/event-emitter"),t("./helpers/timer"),t("./webreader-error"),t("../lang/en-GB.json"));else{var o={exports:{}};a(o,o.exports,i.commands,i.dom,i.recognizer,i.router,i.speaker,i.eventEmitter,i.timer,i.webreaderError,i.enGB),i.WebReader=o.exports}}(this,function(e,t,n,r,i,a,o,u,s,c,f){"use strict";function l(e){return e&&e.__esModule?e:{"default":e}}function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){return window.fetch(e+"/"+t+".json").then(function(e){return e.json()}).then(function(e){return I.set(t,e),e})}function p(e,t){if(t.ctrlKey===!0&&(t.code&&"Space"===t.code||32===t.which))if(e.isInteracting()){var n=O.get(e);n.elements&&g["default"].unhighlightElement(n.elements[n.currentIndex]),e.stopCommand()}else e.receiveCommand()}Object.defineProperty(t,"__esModule",{value:!0});var v=d(n),g=l(r),E=l(i),y=l(a),b=l(o),k=l(u),x=l(s),w=l(c),_=l(f),A=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),R="en-GB",P={delay:300,translationsPath:"",recognizer:{lang:R},speaker:{lang:R,voice:"Google UK English Female"}},T={isInteracting:!1,elements:null,currentIndex:-1},L=new WeakMap,O=new WeakMap,I=new Map([[R,_["default"]]]),M=function(){function e(){var t=this,n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];m(this,e),this.settings=Object.assign({},P,n),this.recognizer=new E["default"](this.settings.recognizer),this.speaker=new b["default"](this.settings.speaker),O.set(this,Object.assign({},T)),L.set(this,new Map);var r=this.settings.recognizer.lang;r&&!I.has(r)&&h(this.settings.translationsPath,r).then(function(){var e='Language "'+r+'" successfully loaded';return k["default"].fireEvent(k["default"].namespace+".languagedownload",document,{data:{lang:r}}),t.speaker.speak(e)},function(e){return k["default"].fireEvent(k["default"].namespace+".languageerror",document,{data:{lang:r}}),t.speaker.speak('An error occurred: the language "'+r+'" was not loaded')})}return A(e,[{key:"isInteracting",value:function(){return O.get(this).isInteracting}},{key:"enableShortcuts",value:function(){var e=L.get(this);return e.set("keydown",p.bind(this,this)),document.documentElement.addEventListener("keydown",e.get("keydown")),this}},{key:"disableShortcuts",value:function(){var e=L.get(this);return document.documentElement.removeEventListener("keydown",e.get("keydown")),e["delete"]("keydown"),this}},{key:"receiveCommand",value:function(){var e=this;return O.get(this).isInteracting=!0,k["default"].fireEvent(k["default"].namespace+".interactionstart",document),this.speaker.speak("Ready").then(function(){return e.recognizer.recognize()}).then(function(t){var n=I.get(e.settings.recognizer.lang);return v.recognizeCommand(t,n)}).then(function(t){return y["default"].route(e,t)})["catch"](function(t){return t instanceof w["default"]?e.speaker.speak(t.message):"aborted"!==t.error&&"interrupted"!==t.error?(O.set(e,Object.assign({},T)),e.speaker.speak("Sorry, I could not recognize the command")):void 0}).then(function(){},function(){}).then(function(){O.get(e).isInteracting=!1,k["default"].fireEvent(k["default"].namespace+".interactionend",document)})}},{key:"stopCommand",value:function(){this.recognizer.abort(),this.speaker.cancel(),O.get(this).isInteracting=!1}},{key:"readHeaders",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=g["default"].getHeaders(t),r=t&&t.level?t.level:-1;return O.get(this).elements=n,n.reduce(function(t,n,i){return t=t.then(function(){return O.get(e).currentIndex=i,g["default"].highlightElement(n),e.speaker.speak(n.textContent+(-1!==r?"":" "+n.nodeName)).then(function(){return g["default"].unhighlightElement(n)})["catch"](function(e){return g["default"].unhighlightElement(n),Promise.reject(e)})}),e.settings.delay>0&&(t=t.then(function(){return x["default"].wait(e.settings.delay)})),t},Promise.resolve())}},{key:"readCurrentElement",value:function(){var e=O.get(this);if(!e.elements)return Promise.reject(new w["default"]("There is not a current element to read"));var t=e.elements[e.currentIndex];return g["default"].highlightElement(t),this.speaker.speak(t.textContent).then(function(){return g["default"].unhighlightElement(t)})["catch"](function(e){return g["default"].unhighlightElement(t),Promise.reject(e)})}},{key:"readPreviousElement",value:function(){var e=O.get(this);return 0===e.currentIndex?Promise.reject(new w["default"]("The current element is the first")):(e.currentIndex--,this.readCurrentElement())}},{key:"readNextElement",value:function(){var e=O.get(this);return e.currentIndex===e.elements.length-1?Promise.reject(new w["default"]("The current element is the last")):(e.currentIndex++,this.readCurrentElement())}},{key:"goToLink",value:function(){var e=O.get(this),t=e.elements?e.elements[e.currentIndex]:null;return t&&"A"===t.nodeName?void window.location.assign(t.href):Promise.reject(new w["default"]("There is not a current link to follow"))}},{key:"readLinks",value:function(e){var t=this,n=g["default"].getLinks(e);return O.get(this).elements=n,n.reduce(function(e,n,r){return e=e.then(function(){return O.get(t).currentIndex=r,t.readCurrentElement()}),t.settings.delay>0&&(e=e.then(function(){return x["default"].wait(t.settings.delay)})),e},Promise.resolve())}},{key:"readMain",value:function(){var e=g["default"].getMain(),t=O.get(this);return t.elements=[e],t.currentIndex=0,e?this.speaker.speak(e.textContent):Promise.reject(new w["default"]("The main content of this page cannot be found"))}},{key:"searchMain",value:function(){var e=g["default"].getMain();if(!e)return Promise.reject(new w["default"]("The main content of this page cannot be found"));var t=e.getAttribute("tabindex");e.setAttribute("tabindex",-1),e.addEventListener("blur",function n(){e.removeEventListener("blur",n),t?e.setAttribute("tabindex",t):e.removeAttribute("tabindex")}),e.focus()}},{key:"readPageTitle",value:function(){var e=g["default"].getTitle();return e?this.speaker.speak("The title of the page is "+e):this.speaker.speak("This page does not have a title")}},{key:"readPageSummary",value:function(){var e=g["default"].getHeaders(),t=g["default"].getLinks();return this.speaker.speak("The page contains "+e.length+" headers and "+t.length+" links")}},{key:"goToPreviousPage",value:function(){window.history.back()}},{key:"goToNextPage",value:function(){window.history.forward()}},{key:"goToHomepage",value:function(){window.location.assign("/")}}]),e}();t["default"]=M,e.exports=t["default"]})},{"../lang/en-GB.json":1,"./commands":3,"./dom/dom":5,"./helpers/event-emitter":9,"./helpers/timer":10,"./reader/recognizer":12,"./reader/speaker":13,"./router":14,"./webreader-error":15}],12:[function(t,n,r){!function(i,a){if("function"==typeof e&&e.amd)e("WebReader",["module","exports","../helpers/event-emitter","../webreader-error"],a);else if("undefined"!=typeof r)a(n,r,t("../helpers/event-emitter"),t("../webreader-error"));else{var o={exports:{}};a(o,o.exports,i.eventEmitter,i.webreaderError),i.WebReader=o.exports}}(this,function(e,t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){return window.SpeechRecognition||window.webkitSpeechRecognition||null}function u(e,t){for(var n in t)e.addEventListener(n,t[n])}function s(e,t){for(var n in t)e.removeEventListener(n,t[n])}Object.defineProperty(t,"__esModule",{value:!0});var c=i(n),f=i(r),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];a(this,e);var n=o();if(!n)throw Error("API not supported");this.recognizer=new n;for(var r in t)t.hasOwnProperty(r)&&void 0!==this.recognizer[r]&&(this.recognizer[r]=t[r])}return l(e,[{key:"recognize",value:function(){var e=this;return new Promise(function(t,n){var r=e.recognizer,i={audiostart:function(){c["default"].fireEvent(c["default"].namespace+".recognitionstart",document)},result:function(e){for(var n=e.resultIndex;n<e.results.length;n++)if(e.results[n].isFinal){var r=e.results[n][0];c["default"].fireEvent(c["default"].namespace+".recognitionresult",document,{data:{result:r}}),t(r.transcript)}},error:function(e){c["default"].fireEvent(c["default"].namespace+".recognitionerror",document,{error:e.error}),n(new f["default"]("An error has occurred while recognizing your speech"))},noMatch:function(){c["default"].fireEvent(c["default"].namespace+".recognitionnomatch",document),n(new f["default"]("Sorry, I could not find a match"))},end:function(){c["default"].fireEvent(c["default"].namespace+".recognitionend",document),s(r,i),n(new f["default"]("Sorry, I could not recognize your speech"))}};u(e.recognizer,i),e.recognizer.start()})}},{key:"abort",value:function(){this.recognizer.abort()}}],[{key:"isSupported",value:function(){return!!o()}}]),e}();t["default"]=d,e.exports=t["default"]})},{"../helpers/event-emitter":9,"../webreader-error":15}],13:[function(t,n,r){!function(i,a){if("function"==typeof e&&e.amd)e("WebReader",["module","exports","../helpers/event-emitter","../webreader-error"],a);else if("undefined"!=typeof r)a(n,r,t("../helpers/event-emitter"),t("../webreader-error"));else{var o={exports:{}};a(o,o.exports,i.eventEmitter,i.webreaderError),i.WebReader=o.exports}}(this,function(e,t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){return speechSynthesis||null}function u(e,t,n){var r=function(r){if(!t.hasOwnProperty(r)||void 0===e[r])return"continue";if("voice"!==r)return e[r]=t[r],"continue";var i=n.filter(function(e){return e.voiceURI===t[r]}).pop();i?e[r]=i:e[r]=n[0]};for(var i in t){r(i)}}Object.defineProperty(t,"__esModule",{value:!0});var s=i(n),c=i(r),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=Symbol("isCancelled"),d=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(a(this,e),this.speaker=o(),this.settings=t,this[l]=!1,!this.speaker)throw Error("API not supported")}return f(e,[{key:"getVoices",value:function(){var e=this;return new Promise(function(t){var n=e.speaker.getVoices();return n.length>1?t(n):void!function(){var n=function(){t(this.speaker.getVoices()),o().removeEventListener("voiceschanged",n)}.bind(e);o().addEventListener("voiceschanged",n)}()})}},{key:"speak",value:function(e){var t=this;return this.getVoices().then(function(n){return new Promise(function(r,i){var a=new window.SpeechSynthesisUtterance(e),o=Object.assign({text:e},t.settings);u(a,t.settings,n),a.addEventListener("start",function(){s["default"].fireEvent(s["default"].namespace+".synthesisstart",document,{data:o})}),a.addEventListener("end",function(){return s["default"].fireEvent(s["default"].namespace+".synthesisend",document,{data:o}),t[l]?(t[l]=!1,i({error:"interrupted"})):void r()}),a.addEventListener("error",function(e){s["default"].fireEvent(s["default"].namespace+".synthesiserror",document,{data:o}),i(new c["default"]("An error has occurred while speaking"))}),t.speaker.speak(a)})})}},{key:"cancel",value:function(){this.speaker.cancel(),this[l]=!0}}],[{key:"isSupported",value:function(){return!!o()}}]),e}();t["default"]=d,e.exports=t["default"]})},{"../helpers/event-emitter":9,"../webreader-error":15}],14:[function(t,n,r){!function(i,a){if("function"==typeof e&&e.amd)e("WebReader",["module","exports","./webreader-error"],a);else if("undefined"!=typeof r)a(n,r,t("./webreader-error"));else{var o={exports:{}};a(o,o.exports,i.webreaderError),i.WebReader=o.exports}}(this,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=r(n),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(){function e(){i(this,e)}return o(e,null,[{key:"route",value:function(e,t){if("READ_ALL_HEADERS"===t.command)return e.readHeaders();if("READ_ALL_LINKS"===t.command)return e.readLinks();if("READ_LEVEL_HEADERS"===t.command)return e.readHeaders({level:t.level});if("READ_MAIN"===t.command)return e.readMain();if("SEARCH_MAIN"===t.command)return e.searchMain();if("READ_AGAIN"===t.command)return e.readCurrentElement();if("READ_PREVIOUS"===t.command)return e.readPreviousElement();if("READ_NEXT"===t.command)return e.readNextElement();if("READ_PAGE_TITLE"===t.command)return e.readPageTitle();if("READ_LINKS_IN_ELEMENT"===t.command)return e.readLinks({ancestor:t.element});if("GO_TO_PREVIOUS_PAGE"===t.command)return e.goToPreviousPage();if("GO_TO_NEXT_PAGE"===t.command)return e.goToNextPage();if("READ_PAGE_SUMMARY"===t.command)return e.readPageSummary();if("GO_TO_HOMEPAGE"===t.command)return e.goToHomepage();if("GO_TO_LINK"===t.command)return e.goToLink();throw new a["default"]("The command is not supported")}}]),e}();t["default"]=u,e.exports=t["default"]})},{"./webreader-error":15}],15:[function(t,n,r){!function(t,i){if("function"==typeof e&&e.amd)e("WebReader",["module","exports"],i);else if("undefined"!=typeof r)i(n,r);else{var a={exports:{}};i(a,a.exports),t.WebReader=a.exports}}(this,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function i(e){n(this,i),this.name=this.constructor.name,this.message=e};t["default"]=r,e.exports=t["default"]})},{}]},{},[11])(11)});
//# sourceMappingURL=web-reader.min.js.map
